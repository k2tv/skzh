###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         06/Jun/2012  13:34:02 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  E:\ChinaSoft\ZStack-CC2530-2.5.1a\Components\mt\MT #
#                          _UTIL.c                                            #
#    Command line       =  -f E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\Source\znp.cfg                    #
#                          (-DMAC_CFG_APP_PENDING_QUEUE=TRUE                  #
#                          "-DZSTACK_DEVICE_BUILD=(DEVICE_BUILD_COORDINATOR   #
#                          | DEVICE_BUILD_ROUTER | DEVICE_BUILD_ENDDEVICE)"   #
#                          -DNWK_AUTO_POLL -DZNP_RUN_WDOG=FALSE               #
#                          -DZNP_UART_BAUD=HAL_UART_BR_115200 -DZIGBEEPRO     #
#                          -DZIGBEE_FRAGMENTATION -DINTER_PAN -DOSAL_CLOCK    #
#                          -DOSAL_SAPI=FALSE -DSAPI_CB_FUNC=FALSE             #
#                          -DHOLD_AUTO_START -DNV_RESTORE -DNV_INIT           #
#                          -DNUM_DISC_ATTEMPTS=0 -DMT_UTIL_FUNC               #
#                          -DMT_SYS_FUNC -DMT_AF_FUNC -DMT_SAPI_FUNC          #
#                          -DMT_SAPI_CB_FUNC -DMT_ZDO_CB_FUNC -DMT_ZDO_FUNC   #
#                          -DMT_ZDO_MGMT -DMT_APP_FUNC) -f                    #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\Tools\CC2530DB\f8wConfig.cfg      #
#                          (-DZIGBEEPRO -DSECURE=0 -DZG_SECURE_DYNAMIC=0      #
#                          -DREFLECTOR -DDEFAULT_CHANLIST=0x00000800          #
#                          -DZDAPP_CONFIG_PAN_ID=0x1235                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100    #
#                          -DREJOIN_POLL_RATE=440) -f                         #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\Tools\CC2530DB\f8wZCL.cfg         #
#                          (-DZCL_READ -DZCL_WRITE -DZCL_BASIC                #
#                          -DZCL_IDENTIFY -DZCL_ON_OFF -DZCL_KEY_ESTABLISH    #
#                          -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4     #
#                          -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10    #
#                          -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10   #
#                          -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING           #
#                          -DZCL_PRICING -DZCL_MESSAGE -DZCL_TUNNELING        #
#                          -DZCL_TOU) -DZCL_DEVICE_MGMT                       #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Components\mt\MT #
#                          _UTIL.c -D POWER_SAVING -lC                        #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\CC2530-Debug\List\ -lA                  #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\CC2530-Debug\List\ --diag_suppress      #
#                          Pe001,Pa010 -o E:\ChinaSoft\ZStack-CC2530-2.5.1a\P #
#                          rojects\zstack\ZNP\CC253x\CC2530-Debug\Obj\ -e     #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1 #
#                          a\Projects\zstack\ZNP\CC253x\Source\ -I            #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\Source\ -I                           #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\SE\Source\ -I                     #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\ZMain\TI2530ZNP\ -I               #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\..\..\Components\hal\include\ -I  #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\..\..\Components\hal\target\CC253 #
#                          0ZNP\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\ZNP\CC253x\..\..\..\..\Components\mac\inc #
#                          lude\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\ZNP\CC253x\..\..\..\..\Components\mac\hig #
#                          h_level\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\ZNP\CC253x\..\..\..\..\Components\mac\ #
#                          low_level\srf04\ -I E:\ChinaSoft\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\ZNP\CC253x\..\..\..\..\Compone #
#                          nts\mac\low_level\srf04\single_chip\ -I            #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\..\..\Components\mt\ -I           #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\..\..\Components\osal\include\    #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\..\..\..\Components\services\sadd #
#                          r\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\z #
#                          stack\ZNP\CC253x\..\..\..\..\Components\services\s #
#                          data\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\ZNP\CC253x\..\..\..\..\Components\stack\a #
#                          f\ -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\z #
#                          stack\ZNP\CC253x\..\..\..\..\Components\stack\nwk\ #
#                           -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zst #
#                          ack\ZNP\CC253x\..\..\..\..\Components\stack\sapi\  #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\..\..\..\Components\stack\sec\    #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\..\..\..\Components\stack\sys\    #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\..\..\..\Components\stack\zcl\    #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\..\..\..\Components\stack\zdo\    #
#                          -I E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zsta #
#                          ck\ZNP\CC253x\..\..\..\..\Components\zmac\ -I      #
#                          E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\..\..\..\..\Components\zmac\f8w\ -Ohz   #
#                          --require_prototypes                               #
#    List file          =  E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\CC2530-Debug\List\MT_UTIL.lst           #
#    Object file        =  E:\ChinaSoft\ZStack-CC2530-2.5.1a\Projects\zstack\ #
#                          ZNP\CC253x\CC2530-Debug\Obj\MT_UTIL.r51            #
#                                                                             #
#                                                                             #
###############################################################################

E:\ChinaSoft\ZStack-CC2530-2.5.1a\Components\mt\MT_UTIL.c
      1          /***************************************************************************************************
      2            Filename:       MT_UTIL.c
      3            Revised:        $Date: 2012-02-25 17:43:09 -0800 (Sat, 25 Feb 2012) $
      4            Revision:       $Revision: 29520 $
      5          
      6            Description:    MonitorTest Utility Functions
      7          
      8            Copyright 2007-2012 Texas Instruments Incorporated. All rights reserved.
      9          
     10            IMPORTANT: Your use of this Software is limited to those specific rights
     11            granted under the terms of a software license agreement between the user
     12            who downloaded the software, his/her employer (which must be your employer)
     13            and Texas Instruments Incorporated (the "License"). You may not use this
     14            Software unless you agree to abide by the terms of the License. The License
     15            limits your use, and you acknowledge, that the Software may not be modified,
     16            copied or distributed unless embedded on a Texas Instruments microcontroller
     17            or used solely and exclusively in conjunction with a Texas Instruments radio
     18            frequency transceiver, which is integrated into your product. Other than for
     19            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     20            works of, modify, distribute, perform, display or sell this Software and/or
     21            its documentation for any purpose.
     22          
     23            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     24            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     25            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     26            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     27            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     28            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     29            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     30            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     31            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     32            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     33            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     34          
     35            Should you have any questions regarding your right to use this Software,
     36            contact Texas Instruments Incorporated at www.TI.com.
     37          
     38           ***************************************************************************************************/
     39          
     40          /***************************************************************************************************
     41           * INCLUDES
     42           ***************************************************************************************************/
     43          #include "ZComDef.h"
     44          
     45          #include "AddrMgr.h"
     46          
     47          #include "OnBoard.h"   /* This is here because of the key reading */
     48          #include "hal_key.h"
     49          #include "hal_led.h"
     50          #include "OSAL_Nv.h"
     51          #include "osal.h"
     52          #include "NLMEDE.h"
     53          #include "MT.h"
     54          #include "MT_UTIL.h"
     55          #include "MT_MAC.h"
     56          #include "ssp.h"
     57          #if defined ZCL_KEY_ESTABLISH
     58          #include "zcl_key_establish.h"
     59          #endif
     60          #if defined TC_LINKKEY_JOIN
     61          #include "zcl_se.h"
     62          #endif
     63          
     64          #if !defined NONWK
     65          #include "MT_ZDO.h"
     66          #include "MT_SAPI.h"
     67          #include "MT_NWK.h"
     68          #include "MT_AF.h"
     69          #include "AssocList.h"
     70          #include "ZDApp.h"
     71          #include "ZDSecMgr.h"
     72          #endif
     73          /***************************************************************************************************
     74           * CONSTANTS
     75           ***************************************************************************************************/
     76          #define MT_UTIL_DEVICE_INFO_RESPONSE_LEN 14
     77          #define MT_UTIL_STATUS_LEN    1
     78          #define MT_UTIL_FRM_CTR_LEN   4
     79          // Status + LinkKeyDataLen + Tx+Rx Frame counter.
     80          #define MT_APSME_LINKKEY_GET_RSP_LEN (MT_UTIL_STATUS_LEN + SEC_KEY_LEN + (MT_UTIL_FRM_CTR_LEN * 2))
     81          // Status + NV id
     82          #define MT_APSME_LINKKEY_NV_ID_GET_RSP_LEN (MT_UTIL_STATUS_LEN + 2)
     83          
     84          /***************************************************************************************************
     85           * LOCAL VARIABLES
     86           ***************************************************************************************************/
     87          #if defined ZCL_KEY_ESTABLISH

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     88          uint8 zcl_key_establish_task_id;
   \                     zcl_key_establish_task_id:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     89          #endif
     90          
     91          /***************************************************************************************************
     92           * LOCAL FUNCTIONS
     93           ***************************************************************************************************/
     94          #ifdef AUTO_PEND
     95          static void MT_UtilRevExtCpy( uint8 *pDst, uint8 *pSrc );
     96          static void MT_UtilSpi2Addr( zAddrType_t *pDst, uint8 *pSrc );
     97          #endif
     98          
     99          #if defined (MT_UTIL_FUNC)
    100          void MT_UtilGetDeviceInfo(void);
    101          void MT_UtilGetNvInfo(void);
    102          void MT_UtilSetPanID(uint8 *pBuf);
    103          void MT_UtilSetChannels(uint8 *pBuf);
    104          void MT_UtilSetSecLevel(uint8 *pBuf);
    105          void MT_UtilSetPreCfgKey(uint8 *pBuf);
    106          void MT_UtilCallbackSub(uint8 *pData);
    107          void MT_UtilKeyEvent(uint8 *pBuf);
    108          void MT_UtilTimeAlive(void);
    109          void MT_UtilLedControl(uint8 *pBuf);
    110          void MT_UtilSrcMatchEnable (uint8 *pBuf);
    111          void MT_UtilSrcMatchAddEntry (uint8 *pBuf);
    112          void MT_UtilSrcMatchDeleteEntry (uint8 *pBuf);
    113          void MT_UtilSrcMatchCheckSrcAddr (uint8 *pBuf);
    114          void MT_UtilSrcMatchAckAllPending (uint8 *pBuf);
    115          void MT_UtilSrcMatchCheckAllPending (uint8 *pBuf);
    116          
    117          #if !defined NONWK
    118          void MT_UtilDataReq(uint8 *pBuf);
    119          static void MT_UtilAddrMgrEntryLookupExt(uint8 *pBuf);
    120          static void MT_UtilAddrMgrEntryLookupNwk(uint8 *pBuf);
    121          #if defined MT_SYS_KEY_MANAGEMENT
    122          static void MT_UtilAPSME_LinkKeyDataGet(uint8 *pBuf);
    123          static void MT_UtilAPSME_LinkKeyNvIdGet(uint8 *pBuf);
    124          #endif //MT_SYS_KEY_MANAGEMENT
    125          static void MT_UtilAPSME_RequestKeyCmd(uint8 *pBuf);
    126          static void MT_UtilAssocCount(uint8 *pBuf);
    127          static void MT_UtilAssocFindDevice(uint8 *pBuf);
    128          static void MT_UtilAssocGetWithAddress(uint8 *pBuf);
    129          static void packDev_t(uint8 *pBuf, associated_devices_t *pDev);
    130          #if defined ZCL_KEY_ESTABLISH
    131          static void MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(uint8 *pBuf);
    132          static void MT_UtilzclGeneral_KeyEstablishment_ECDSASign(uint8 *pBuf);
    133          #endif // ZCL_KEY_ESTABLISH
    134          static void MT_UtilSync(void);
    135          #endif // !defined NONWK
    136          #endif // MT_UTIL_FUNC
    137          
    138          #if defined (MT_UTIL_FUNC)
    139          /***************************************************************************************************
    140           * @fn      MT_UtilProcessing
    141           *
    142           * @brief   Process all the DEBUG commands that are issued by test tool
    143           *
    144           * @param   pBuf  - pointer to received SPI data message
    145           *
    146           * @return  status
    147           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    148          uint8 MT_UtilCommandProcessing(uint8 *pBuf)
   \                     MT_UtilCommandProcessing:
    149          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 22
   \   000005   74EA         MOV     A,#-0x16
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    150            uint8 status = MT_RPC_SUCCESS;
   \   00000A   75..00       MOV     ?V0 + 2,#0x0
    151          
    152            switch (pBuf[MT_RPC_POS_CMD1])
   \   00000D   8A82         MOV     DPL,R2
   \   00000F   8B83         MOV     DPH,R3
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   7003         JNZ     $+5
   \   000016   02....       LJMP    ??MT_UtilCommandProcessing_0 & 0xFFFF
   \   000019   14           DEC     A
   \   00001A   7003         JNZ     $+5
   \   00001C   02....       LJMP    ??MT_UtilCommandProcessing_1 & 0xFFFF
   \   00001F   14           DEC     A
   \   000020   7003         JNZ     $+5
   \   000022   02....       LJMP    ??MT_UtilCommandProcessing_2 & 0xFFFF
   \   000025   14           DEC     A
   \   000026   7003         JNZ     $+5
   \   000028   02....       LJMP    ??MT_UtilCommandProcessing_3 & 0xFFFF
   \   00002B   14           DEC     A
   \   00002C   7003         JNZ     $+5
   \   00002E   02....       LJMP    ??MT_UtilCommandProcessing_4 & 0xFFFF
   \   000031   14           DEC     A
   \   000032   7003         JNZ     $+5
   \   000034   02....       LJMP    ??MT_UtilCommandProcessing_5 & 0xFFFF
   \   000037   14           DEC     A
   \   000038   7003         JNZ     $+5
   \   00003A   02....       LJMP    ??MT_UtilCommandProcessing_6 & 0xFFFF
   \   00003D   14           DEC     A
   \   00003E   7003         JNZ     $+5
   \   000040   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
   \   000043   24FE         ADD     A,#-0x2
   \   000045   7003         JNZ     $+5
   \   000047   02....       LJMP    ??MT_UtilCommandProcessing_8 & 0xFFFF
   \   00004A   14           DEC     A
   \   00004B   7003         JNZ     $+5
   \   00004D   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
   \   000050   24FA         ADD     A,#-0x6
   \   000052   7003         JNZ     $+5
   \   000054   02....       LJMP    ??MT_UtilCommandProcessing_9 & 0xFFFF
   \   000057   14           DEC     A
   \   000058   7003         JNZ     $+5
   \   00005A   02....       LJMP    ??MT_UtilCommandProcessing_10 & 0xFFFF
   \   00005D   24F1         ADD     A,#-0xf
   \   00005F   7003         JNZ     $+5
   \   000061   02....       LJMP    ??MT_UtilCommandProcessing_11 & 0xFFFF
   \   000064   14           DEC     A
   \   000065   7003         JNZ     $+5
   \   000067   02....       LJMP    ??MT_UtilCommandProcessing_12 & 0xFFFF
   \   00006A   14           DEC     A
   \   00006B   7003         JNZ     $+5
   \   00006D   02....       LJMP    ??MT_UtilCommandProcessing_13 & 0xFFFF
   \   000070   14           DEC     A
   \   000071   7003         JNZ     $+5
   \   000073   02....       LJMP    ??MT_UtilCommandProcessing_14 & 0xFFFF
   \   000076   14           DEC     A
   \   000077   7003         JNZ     $+5
   \   000079   02....       LJMP    ??MT_UtilCommandProcessing_15 & 0xFFFF
   \   00007C   14           DEC     A
   \   00007D   7003         JNZ     $+5
   \   00007F   02....       LJMP    ??MT_UtilCommandProcessing_16 & 0xFFFF
   \   000082   24E5         ADD     A,#-0x1b
   \   000084   7003         JNZ     $+5
   \   000086   02....       LJMP    ??MT_UtilCommandProcessing_17 & 0xFFFF
   \   000089   14           DEC     A
   \   00008A   7003         JNZ     $+5
   \   00008C   02....       LJMP    ??MT_UtilCommandProcessing_18 & 0xFFFF
   \   00008F   24F9         ADD     A,#-0x7
   \   000091   7003         JNZ     $+5
   \   000093   02....       LJMP    ??MT_UtilCommandProcessing_19 & 0xFFFF
   \   000096   14           DEC     A
   \   000097   7003         JNZ     $+5
   \   000099   02....       LJMP    ??MT_UtilCommandProcessing_20 & 0xFFFF
   \   00009C   14           DEC     A
   \   00009D   7003         JNZ     $+5
   \   00009F   02....       LJMP    ??MT_UtilCommandProcessing_21 & 0xFFFF
   \   0000A2   14           DEC     A
   \   0000A3   7003         JNZ     $+5
   \   0000A5   02....       LJMP    ??MT_UtilCommandProcessing_22 & 0xFFFF
   \   0000A8   24CB         ADD     A,#-0x35
   \   0000AA   7003         JNZ     $+5
   \   0000AC   02....       LJMP    ??MT_UtilCommandProcessing_23 & 0xFFFF
   \   0000AF   14           DEC     A
   \   0000B0   7003         JNZ     $+5
   \   0000B2   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
   \   0000B5   24A1         ADD     A,#-0x5f
   \   0000B7   7003         JNZ     $+5
   \   0000B9   02....       LJMP    ??MT_UtilCommandProcessing_24 & 0xFFFF
   \   0000BC   02....       LJMP    ??MT_UtilCommandProcessing_25 & 0xFFFF
    153            {
    154          // CC253X MAC Network Processor does not have NV support
    155          #if !defined(CC253X_MACNP)
    156              case MT_UTIL_GET_DEVICE_INFO:
    157                MT_UtilGetDeviceInfo();
   \                     ??MT_UtilCommandProcessing_0:
   \   0000BF                ; Setup parameters for call to function MT_UtilGetDeviceInfo
   \   0000BF   12....       LCALL   ??MT_UtilGetDeviceInfo?relay
    158                break;
   \   0000C2   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    159          
    160              case MT_UTIL_GET_NV_INFO:
    161                MT_UtilGetNvInfo();
   \                     ??MT_UtilCommandProcessing_1:
   \   0000C5                ; Setup parameters for call to function MT_UtilGetNvInfo
   \   0000C5   12....       LCALL   ??MT_UtilGetNvInfo?relay
    162                break;
   \   0000C8   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    163          
    164              case MT_UTIL_SET_PANID:
    165                MT_UtilSetPanID(pBuf);
   \                     ??MT_UtilCommandProcessing_2:
   \   0000CB                ; Setup parameters for call to function MT_UtilSetPanID
   \   0000CB   12....       LCALL   ??MT_UtilSetPanID?relay
    166                break;
   \   0000CE   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    167          
    168              case MT_UTIL_SET_CHANNELS:
    169                MT_UtilSetChannels(pBuf);
   \                     ??MT_UtilCommandProcessing_3:
   \   0000D1                ; Setup parameters for call to function MT_UtilSetChannels
   \   0000D1   12....       LCALL   ??MT_UtilSetChannels?relay
    170                break;
   \   0000D4   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    171          
    172              case MT_UTIL_SET_SECLEVEL:
    173                MT_UtilSetSecLevel(pBuf);
   \                     ??MT_UtilCommandProcessing_4:
   \   0000D7                ; Setup parameters for call to function MT_UtilSetSecLevel
   \   0000D7   12....       LCALL   ??MT_UtilSetSecLevel?relay
    174                break;
   \   0000DA   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    175          
    176              case MT_UTIL_SET_PRECFGKEY:
    177                MT_UtilSetPreCfgKey(pBuf);
   \                     ??MT_UtilCommandProcessing_5:
   \   0000DD                ; Setup parameters for call to function MT_UtilSetPreCfgKey
   \   0000DD   12....       LCALL   ??MT_UtilSetPreCfgKey?relay
    178                break;
   \   0000E0   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    179          #endif
    180              case MT_UTIL_CALLBACK_SUB_CMD:
    181                MT_UtilCallbackSub(pBuf);
   \                     ??MT_UtilCommandProcessing_6:
   \   0000E3                ; Setup parameters for call to function MT_UtilCallbackSub
   \   0000E3   12....       LCALL   ??MT_UtilCallbackSub?relay
    182                break;
   \   0000E6   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    183          
    184              case MT_UTIL_KEY_EVENT:
    185          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    186                MT_UtilKeyEvent(pBuf);
    187          #endif
    188                break;
    189          
    190              case MT_UTIL_TIME_ALIVE:
    191                MT_UtilTimeAlive();
   \                     ??MT_UtilCommandProcessing_8:
   \   0000E9                ; Setup parameters for call to function MT_UtilTimeAlive
   \   0000E9   12....       LCALL   ??MT_UtilTimeAlive?relay
    192                break;
   \   0000EC   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    193          
    194              case MT_UTIL_LED_CONTROL:
    195          #if (defined HAL_LED) && (HAL_LED == TRUE)
    196                MT_UtilLedControl(pBuf);
    197          #endif
    198                break;
    199          
    200              case MT_UTIL_SRC_MATCH_ENABLE:
    201                MT_UtilSrcMatchEnable(pBuf);
   \                     ??MT_UtilCommandProcessing_11:
   \   0000EF                ; Setup parameters for call to function MT_UtilSrcMatchEnable
   \   0000EF   12....       LCALL   ??MT_UtilSrcMatchEnable?relay
    202                break;
   \   0000F2   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    203          
    204              case MT_UTIL_SRC_MATCH_ADD_ENTRY:
    205                MT_UtilSrcMatchAddEntry(pBuf);
   \                     ??MT_UtilCommandProcessing_12:
   \   0000F5                ; Setup parameters for call to function MT_UtilSrcMatchAddEntry
   \   0000F5   12....       LCALL   ??MT_UtilSrcMatchAddEntry?relay
    206                break;
   \   0000F8   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    207          
    208              case MT_UTIL_SRC_MATCH_DEL_ENTRY:
    209                MT_UtilSrcMatchDeleteEntry(pBuf);
   \                     ??MT_UtilCommandProcessing_13:
   \   0000FB                ; Setup parameters for call to function MT_UtilSrcMatchDeleteEntry
   \   0000FB   12....       LCALL   ??MT_UtilSrcMatchDeleteEntry?relay
    210                break;
   \   0000FE   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    211          
    212              case MT_UTIL_SRC_MATCH_CHECK_SRC_ADDR:
    213                MT_UtilSrcMatchCheckSrcAddr(pBuf);
   \                     ??MT_UtilCommandProcessing_14:
   \   000101                ; Setup parameters for call to function MT_UtilSrcMatchCheckSrcAddr
   \   000101   12....       LCALL   ??MT_UtilSrcMatchCheckSrcAddr?relay
    214                break;
   \   000104   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    215          
    216              case MT_UTIL_SRC_MATCH_ACK_ALL_PENDING:
    217                MT_UtilSrcMatchAckAllPending(pBuf);
   \                     ??MT_UtilCommandProcessing_15:
   \   000107                ; Setup parameters for call to function MT_UtilSrcMatchAckAllPending
   \   000107   12....       LCALL   ??MT_UtilSrcMatchAckAllPending?relay
    218                break;
   \   00010A   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    219          
    220              case MT_UTIL_SRC_MATCH_CHECK_ALL_PENDING:
    221                MT_UtilSrcMatchCheckAllPending(pBuf);
   \                     ??MT_UtilCommandProcessing_16:
   \   00010D                ; Setup parameters for call to function MT_UtilSrcMatchCheckAllPending
   \   00010D   12....       LCALL   ??MT_UtilSrcMatchCheckAllPending?relay
    222                break;
   \   000110   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    223          
    224              case MT_UTIL_TEST_LOOPBACK:
    225                MT_BuildAndSendZToolResponse((MT_RPC_CMD_SRSP|(uint8)MT_RPC_SYS_UTIL), MT_UTIL_TEST_LOOPBACK,
    226                                              pBuf[MT_RPC_POS_LEN], (pBuf+MT_RPC_FRAME_HDR_SZ));
   \                     ??MT_UtilCommandProcessing_9:
   \   000113                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000113   EA           MOV     A,R2
   \   000114   2403         ADD     A,#0x3
   \   000116   FC           MOV     R4,A
   \   000117   EB           MOV     A,R3
   \   000118   3400         ADDC    A,#0x0
   \   00011A   FD           MOV     R5,A
   \   00011B   8A82         MOV     DPL,R2
   \   00011D   8B83         MOV     DPH,R3
   \   00011F   E0           MOVX    A,@DPTR
   \   000120   FB           MOV     R3,A
   \   000121   7A10         MOV     R2,#0x10
   \                     ??MT_UtilCommandProcessing_26:
   \   000123   7967         MOV     R1,#0x67
   \                     ??MT_UtilCommandProcessing_27:
   \   000125   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    227                break;
   \   000128   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    228          
    229          #if !defined NONWK
    230              case MT_UTIL_DATA_REQ:
    231                MT_UtilDataReq(pBuf);
   \                     ??MT_UtilCommandProcessing_10:
   \   00012B                ; Setup parameters for call to function MT_UtilDataReq
   \   00012B   12....       LCALL   ??MT_UtilDataReq?relay
    232                break;
   \   00012E   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    233          
    234              case MT_UTIL_ADDRMGR_EXT_ADDR_LOOKUP:
    235                MT_UtilAddrMgrEntryLookupExt(pBuf);
   \                     ??MT_UtilCommandProcessing_17:
   \   000131                ; Setup parameters for call to function MT_UtilAddrMgrEntryLookupExt
   \   000131   12....       LCALL   ??MT_UtilAddrMgrEntryLookupExt?relay
    236                break;
   \   000134   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
    237          
    238              case MT_UTIL_ADDRMGR_NWK_ADDR_LOOKUP:
    239                MT_UtilAddrMgrEntryLookupNwk(pBuf);
   \                     ??MT_UtilCommandProcessing_18:
   \   000137   8A82         MOV     DPL,R2
   \   000139   8B83         MOV     DPH,R3
   \   00013B   A3           INC     DPTR
   \   00013C   A3           INC     DPTR
   \   00013D   E0           MOVX    A,@DPTR
   \   00013E   FE           MOV     R6,A
   \   00013F   EA           MOV     A,R2
   \   000140   2403         ADD     A,#0x3
   \   000142   F582         MOV     DPL,A
   \   000144   EB           MOV     A,R3
   \   000145   3400         ADDC    A,#0x0
   \   000147   F583         MOV     DPH,A
   \   000149   E0           MOVX    A,@DPTR
   \   00014A   FA           MOV     R2,A
   \   00014B   A3           INC     DPTR
   \   00014C   E0           MOVX    A,@DPTR
   \   00014D   F9           MOV     R1,A
   \   00014E   EA           MOV     A,R2
   \   00014F   F8           MOV     R0,A
   \   000150   740A         MOV     A,#0xa
   \   000152   12....       LCALL   ?XSTACK_DISP0_8
   \   000155   E8           MOV     A,R0
   \   000156   F0           MOVX    @DPTR,A
   \   000157   A3           INC     DPTR
   \   000158   E9           MOV     A,R1
   \   000159   F0           MOVX    @DPTR,A
   \   00015A                ; Setup parameters for call to function AddrMgrEntryLookupNwk
   \   00015A   7409         MOV     A,#0x9
   \   00015C   12....       LCALL   ?XSTACK_DISP0_8
   \   00015F   AA82         MOV     R2,DPL
   \   000161   AB83         MOV     R3,DPH
   \   000163   12....       LCALL   ??AddrMgrEntryLookupNwk?relay
   \   000166                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000166   740C         MOV     A,#0xc
   \   000168   12....       LCALL   ?XSTACK_DISP0_8
   \   00016B   AC82         MOV     R4,DPL
   \   00016D   AD83         MOV     R5,DPH
   \   00016F   7B08         MOV     R3,#0x8
   \                     ??MT_UtilCommandProcessing_28:
   \   000171   EE           MOV     A,R6
   \   000172   FA           MOV     R2,A
   \   000173   80AE         SJMP    ??MT_UtilCommandProcessing_26
    240                break;
    241          
    242          #if defined MT_SYS_KEY_MANAGEMENT
    243              case MT_UTIL_APSME_LINK_KEY_DATA_GET:
    244                MT_UtilAPSME_LinkKeyDataGet(pBuf);
    245                break;
    246          
    247              case MT_UTIL_APSME_LINK_KEY_NV_ID_GET:
    248                MT_UtilAPSME_LinkKeyNvIdGet(pBuf);
    249                break;
    250          #endif // MT_SYS_KEY_MANAGEMENT
    251          
    252              case MT_UTIL_APSME_REQUEST_KEY_CMD:
    253                MT_UtilAPSME_RequestKeyCmd(pBuf);
   \                     ??MT_UtilCommandProcessing_22:
   \   000175   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   000178   89..         MOV     ?V0 + 4,R1
   \   00017A   8A..         MOV     ?V0 + 5,R2
   \   00017C   75..00       MOV     ?V0 + 6,#0x0
   \   00017F   78..         MOV     R0,#?V0 + 4
   \   000181   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000184   7C08         MOV     R4,#0x8
   \   000186   7D00         MOV     R5,#0x0
   \   000188   7404         MOV     A,#0x4
   \   00018A   12....       LCALL   ?XSTACK_DISP0_8
   \   00018D   AA82         MOV     R2,DPL
   \   00018F   AB83         MOV     R3,DPH
   \   000191   12....       LCALL   ??osal_memcpy?relay
   \   000194   7403         MOV     A,#0x3
   \   000196   12....       LCALL   ?DEALLOC_XSTACK8
   \   000199                ; Setup parameters for call to function ZDSecMgrRequestAppKey
   \   000199   7401         MOV     A,#0x1
   \   00019B   12....       LCALL   ?XSTACK_DISP0_8
   \   00019E   AA82         MOV     R2,DPL
   \   0001A0   AB83         MOV     R3,DPH
   \   0001A2   12....       LCALL   ??ZDSecMgrRequestAppKey?relay
   \   0001A5   12....       LCALL   ?Subroutine23 & 0xFFFF
   \                     ??CrossCallReturnLabel_62:
   \   0001A8   80C7         SJMP    ??MT_UtilCommandProcessing_28
    254                break;
    255          
    256              case MT_UTIL_ASSOC_COUNT:
    257                MT_UtilAssocCount(pBuf);
   \                     ??MT_UtilCommandProcessing_19:
   \   0001AA   8A82         MOV     DPL,R2
   \   0001AC   8B83         MOV     DPH,R3
   \   0001AE   A3           INC     DPTR
   \   0001AF   A3           INC     DPTR
   \   0001B0   E0           MOVX    A,@DPTR
   \   0001B1   F5..         MOV     ?V0 + 3,A
   \   0001B3   EA           MOV     A,R2
   \   0001B4   2403         ADD     A,#0x3
   \   0001B6   F8           MOV     R0,A
   \   0001B7   EB           MOV     A,R3
   \   0001B8   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   0001BB   A3           INC     DPTR
   \   0001BC   8582..       MOV     ?V0 + 0,DPL
   \   0001BF   8583..       MOV     ?V0 + 1,DPH
   \   0001C2                ; Setup parameters for call to function AssocCount
   \   0001C2   E0           MOVX    A,@DPTR
   \   0001C3   FA           MOV     R2,A
   \   0001C4   8E82         MOV     DPL,R6
   \   0001C6   8F83         MOV     DPH,R7
   \   0001C8   E0           MOVX    A,@DPTR
   \   0001C9   F9           MOV     R1,A
   \   0001CA   12....       LCALL   ??AssocCount?relay
   \   0001CD   EA           MOV     A,R2
   \   0001CE   8E82         MOV     DPL,R6
   \   0001D0   8F83         MOV     DPH,R7
   \   0001D2   F0           MOVX    @DPTR,A
   \   0001D3   85..82       MOV     DPL,?V0 + 0
   \   0001D6   85..83       MOV     DPH,?V0 + 1
   \   0001D9   EB           MOV     A,R3
   \   0001DA   F0           MOVX    @DPTR,A
   \   0001DB                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001DB   EE           MOV     A,R6
   \   0001DC   FC           MOV     R4,A
   \   0001DD   EF           MOV     A,R7
   \   0001DE   FD           MOV     R5,A
   \   0001DF   7B02         MOV     R3,#0x2
   \   0001E1   AA..         MOV     R2,?V0 + 3
   \   0001E3   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    258                break;
    259          
    260              case MT_UTIL_ASSOC_FIND_DEVICE:
    261                MT_UtilAssocFindDevice(pBuf);
   \                     ??MT_UtilCommandProcessing_20:
   \   0001E6                ; Setup parameters for call to function MT_UtilAssocFindDevice
   \   0001E6   12....       LCALL   ??MT_UtilAssocFindDevice?relay
    262                break;
   \   0001E9   801A         SJMP    ??MT_UtilCommandProcessing_7
    263          
    264              case MT_UTIL_ASSOC_GET_WITH_ADDRESS:
    265                MT_UtilAssocGetWithAddress(pBuf);
   \                     ??MT_UtilCommandProcessing_21:
   \   0001EB                ; Setup parameters for call to function MT_UtilAssocGetWithAddress
   \   0001EB   12....       LCALL   ??MT_UtilAssocGetWithAddress?relay
    266                break;
   \   0001EE   8015         SJMP    ??MT_UtilCommandProcessing_7
    267          
    268          #if defined ZCL_KEY_ESTABLISH
    269              case MT_UTIL_ZCL_KEY_EST_INIT_EST:
    270                MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(pBuf);
   \                     ??MT_UtilCommandProcessing_23:
   \   0001F0                ; Setup parameters for call to function MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
   \   0001F0   12....       LCALL   ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst
    271                break;
   \   0001F3   8010         SJMP    ??MT_UtilCommandProcessing_7
    272          
    273              case MT_UTIL_ZCL_KEY_EST_SIGN:
    274                MT_UtilzclGeneral_KeyEstablishment_ECDSASign(pBuf);
    275                break;
    276          #endif
    277          
    278              case MT_UTIL_SYNC_REQ:
    279                MT_UtilSync();
   \                     ??MT_UtilCommandProcessing_24:
   \   0001F5                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001F5   7C00         MOV     R4,#0x0
   \   0001F7   7D00         MOV     R5,#0x0
   \   0001F9   7B00         MOV     R3,#0x0
   \   0001FB   7AE0         MOV     R2,#-0x20
   \   0001FD   7947         MOV     R1,#0x47
   \   0001FF   02....       LJMP    ??MT_UtilCommandProcessing_27 & 0xFFFF
    280                break;
    281          #endif /* !defined NONWK */
    282          
    283              default:
    284                status = MT_RPC_ERR_COMMAND_ID;
   \                     ??MT_UtilCommandProcessing_25:
   \   000202   75..02       MOV     ?V0 + 2,#0x2
    285                break;
    286            }
    287          
    288            return status;
   \                     ??MT_UtilCommandProcessing_7:
   \   000205   A9..         MOV     R1,?V0 + 2
   \   000207   7416         MOV     A,#0x16
   \   000209   12....       LCALL   ?DEALLOC_XSTACK8
   \   00020C   7F07         MOV     R7,#0x7
   \   00020E   02....       LJMP    ?BANKED_LEAVE_XDATA
    289          }
    290          
    291          /***************************************************************************************************
    292           * @fn      MT_UtilGetDeviceInfo
    293           *
    294           * @brief   The Get Device Info serial message.
    295           *
    296           * @param   None.
    297           *
    298           * @return  void
    299           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    300          void MT_UtilGetDeviceInfo(void)
   \                     MT_UtilGetDeviceInfo:
    301          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    302            uint8  *buf;
    303            uint8  *pBuf;
    304            uint8  bufLen = MT_UTIL_DEVICE_INFO_RESPONSE_LEN;
   \   00000A   75..0E       MOV     ?V0 + 2,#0xe
    305            uint16 *assocList = NULL;
   \   00000D   7E00         MOV     R6,#0x0
   \   00000F   7F00         MOV     R7,#0x0
    306          
    307          #if !defined NONWK
    308            uint8  assocCnt = 0;
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   E4           CLR     A
   \   000018   F0           MOVX    @DPTR,A
    309          
    310            if (ZG_DEVICE_RTR_TYPE)
   \   000019   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   6004         JZ      ??MT_UtilGetDeviceInfo_0
   \   00001F   6401         XRL     A,#0x1
   \   000021   7022         JNZ     ??MT_UtilGetDeviceInfo_1
    311            {
    312              assocList = AssocMakeList( &assocCnt );
   \                     ??MT_UtilGetDeviceInfo_0:
   \   000023                ; Setup parameters for call to function AssocMakeList
   \   000023   85..82       MOV     DPL,?XSP + 0
   \   000026   85..83       MOV     DPH,?XSP + 1
   \   000029   AA82         MOV     R2,DPL
   \   00002B   AB83         MOV     R3,DPH
   \   00002D   12....       LCALL   ??AssocMakeList?relay
   \   000030   8A..         MOV     ?V0 + 0,R2
   \   000032   8B..         MOV     ?V0 + 1,R3
   \   000034   AE..         MOV     R6,?V0 + 0
   \   000036   AF..         MOV     R7,?V0 + 1
    313              bufLen += (assocCnt * sizeof(uint16));
   \   000038   85..82       MOV     DPL,?XSP + 0
   \   00003B   85..83       MOV     DPH,?XSP + 1
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   C3           CLR     C
   \   000040   33           RLC     A
   \   000041   240E         ADD     A,#0xe
   \   000043   F5..         MOV     ?V0 + 2,A
    314            }
    315          #endif
    316          
    317            buf = osal_mem_alloc( bufLen );
   \                     ??MT_UtilGetDeviceInfo_1:
   \   000045                ; Setup parameters for call to function osal_mem_alloc
   \   000045   85....       MOV     ?V0 + 0,?V0 + 2
   \   000048   AA..         MOV     R2,?V0 + 0
   \   00004A   7B00         MOV     R3,#0x0
   \   00004C   12....       LCALL   ??osal_mem_alloc?relay
   \   00004F   8A..         MOV     ?V0 + 0,R2
   \   000051   8B..         MOV     ?V0 + 1,R3
    318            if ( buf )
   \   000053   EA           MOV     A,R2
   \   000054   45..         ORL     A,?V0 + 1
   \   000056   7003         JNZ     $+5
   \   000058   02....       LJMP    ??MT_UtilGetDeviceInfo_2 & 0xFFFF
    319            {
    320              pBuf = buf;
    321          
    322              *pBuf++ = ZSUCCESS; // Status
   \   00005B   8A82         MOV     DPL,R2
   \   00005D   8B83         MOV     DPH,R3
   \   00005F   E4           CLR     A
   \   000060   12....       LCALL   ?Subroutine27 & 0xFFFF
    323          
    324              osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \                     ??CrossCallReturnLabel_38:
   \   000063                ; Setup parameters for call to function osal_nv_read
   \   000063   78..         MOV     R0,#?V0 + 4
   \   000065   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000068   75..08       MOV     ?V0 + 6,#0x8
   \   00006B   75..00       MOV     ?V0 + 7,#0x0
   \   00006E   78..         MOV     R0,#?V0 + 6
   \   000070   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000073   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_65:
   \   000076   12....       LCALL   ?DEALLOC_XSTACK8
    325              pBuf += Z_EXTADDR_LEN;
   \   000079   E5..         MOV     A,?V0 + 4
   \   00007B   2408         ADD     A,#0x8
   \   00007D   F5..         MOV     ?V0 + 4,A
   \   00007F   E5..         MOV     A,?V0 + 5
   \   000081   3400         ADDC    A,#0x0
   \   000083   F5..         MOV     ?V0 + 5,A
    326          
    327          #if defined NONWK
    328              // Skip past ZStack only parameters for NONWK
    329              *pBuf++ = 0;
    330              *pBuf++ = 0;
    331              *pBuf++ = 0;
    332              *pBuf++ = 0;
    333              *pBuf = 0;
    334          #else
    335              {
    336                uint16 shortAddr = NLME_GetShortAddr();
   \   000085                ; Setup parameters for call to function NLME_GetShortAddr
   \   000085   12....       LCALL   ??NLME_GetShortAddr?relay
    337                *pBuf++ = LO_UINT16( shortAddr );
   \   000088   EA           MOV     A,R2
   \   000089   85..82       MOV     DPL,?V0 + 4
   \   00008C   85..83       MOV     DPH,?V0 + 5
   \   00008F   F0           MOVX    @DPTR,A
   \   000090   A3           INC     DPTR
    338                *pBuf++ = HI_UINT16( shortAddr );
   \   000091   EB           MOV     A,R3
   \   000092   F0           MOVX    @DPTR,A
   \   000093   A3           INC     DPTR
    339              }
    340          
    341              /* Return device type */
    342              *pBuf++ = ZSTACK_DEVICE_BUILD;
   \   000094   7407         MOV     A,#0x7
   \   000096   12....       LCALL   ?Subroutine27 & 0xFFFF
    343          
    344              /*Return device state */
    345              *pBuf++ = (uint8)devState;
   \                     ??CrossCallReturnLabel_39:
   \   000099   90....       MOV     DPTR,#devState
   \   00009C   12....       LCALL   ?Subroutine6 & 0xFFFF
    346          
    347              if (ZG_DEVICE_RTR_TYPE)
   \                     ??CrossCallReturnLabel_0:
   \   00009F   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0000A2   E0           MOVX    A,@DPTR
   \   0000A3   6004         JZ      ??MT_UtilGetDeviceInfo_3
   \   0000A5   6401         XRL     A,#0x1
   \   0000A7   7040         JNZ     ??MT_UtilGetDeviceInfo_4
    348              {
    349                *pBuf++ = assocCnt;
   \                     ??MT_UtilGetDeviceInfo_3:
   \   0000A9   85..82       MOV     DPL,?XSP + 0
   \   0000AC   85..83       MOV     DPH,?XSP + 1
   \   0000AF   12....       LCALL   ?Subroutine6 & 0xFFFF
    350          
    351                if ( assocCnt )
   \                     ??CrossCallReturnLabel_1:
   \   0000B2   85..82       MOV     DPL,?XSP + 0
   \   0000B5   85..83       MOV     DPH,?XSP + 1
   \   0000B8   E0           MOVX    A,@DPTR
   \   0000B9   6036         JZ      ??MT_UtilGetDeviceInfo_5
    352                {
    353                  uint8 x;
    354                  uint16 *puint16 = assocList;
   \   0000BB   EE           MOV     A,R6
   \   0000BC   F8           MOV     R0,A
   \   0000BD   EF           MOV     A,R7
   \   0000BE   F9           MOV     R1,A
    355          
    356                  for ( x = 0; x < assocCnt; x++, puint16++ )
   \   0000BF   7C00         MOV     R4,#0x0
   \                     ??MT_UtilGetDeviceInfo_6:
   \   0000C1   85..82       MOV     DPL,?XSP + 0
   \   0000C4   85..83       MOV     DPH,?XSP + 1
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   FA           MOV     R2,A
   \   0000C9   EC           MOV     A,R4
   \   0000CA   C3           CLR     C
   \   0000CB   9A           SUBB    A,R2
   \   0000CC   5023         JNC     ??MT_UtilGetDeviceInfo_5
    357                  {
    358                    *pBuf++ = LO_UINT16( *puint16 );
   \   0000CE   8882         MOV     DPL,R0
   \   0000D0   8983         MOV     DPH,R1
   \   0000D2   12....       LCALL   ?Subroutine6 & 0xFFFF
    359                    *pBuf++ = HI_UINT16( *puint16 );
   \                     ??CrossCallReturnLabel_2:
   \   0000D5   8882         MOV     DPL,R0
   \   0000D7   8983         MOV     DPH,R1
   \   0000D9   A3           INC     DPTR
   \   0000DA   12....       LCALL   ?Subroutine6 & 0xFFFF
    360                  }
   \                     ??CrossCallReturnLabel_3:
   \   0000DD   0C           INC     R4
   \   0000DE   E8           MOV     A,R0
   \   0000DF   2402         ADD     A,#0x2
   \   0000E1   08           INC     R0
   \   0000E2   08           INC     R0
   \   0000E3   E9           MOV     A,R1
   \   0000E4   3400         ADDC    A,#0x0
   \   0000E6   F9           MOV     R1,A
   \   0000E7   80D8         SJMP    ??MT_UtilGetDeviceInfo_6
    361                }
    362              }
    363              else
    364              {
    365                *pBuf++ = 0;
   \                     ??MT_UtilGetDeviceInfo_4:
   \   0000E9   85..82       MOV     DPL,?V0 + 4
   \   0000EC   85..83       MOV     DPH,?V0 + 5
   \   0000EF   E4           CLR     A
   \   0000F0   F0           MOVX    @DPTR,A
    366              }
    367          #endif
    368          
    369              MT_BuildAndSendZToolResponse( ((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
    370                                           MT_UTIL_GET_DEVICE_INFO,
    371                                           bufLen, buf );
   \                     ??MT_UtilGetDeviceInfo_5:
   \   0000F1                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000F1   AC..         MOV     R4,?V0 + 0
   \   0000F3   AD..         MOV     R5,?V0 + 1
   \   0000F5   AB..         MOV     R3,?V0 + 2
   \   0000F7   7A00         MOV     R2,#0x0
   \   0000F9   7967         MOV     R1,#0x67
   \   0000FB   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    372          
    373              osal_mem_free( buf );
   \   0000FE                ; Setup parameters for call to function osal_mem_free
   \   0000FE   AA..         MOV     R2,?V0 + 0
   \   000100   AB..         MOV     R3,?V0 + 1
   \   000102   12....       LCALL   ??osal_mem_free?relay
    374            }
    375          
    376            if ( assocList )
   \                     ??MT_UtilGetDeviceInfo_2:
   \   000105   EE           MOV     A,R6
   \   000106   4F           ORL     A,R7
   \   000107   6007         JZ      ??MT_UtilGetDeviceInfo_7
    377            {
    378              osal_mem_free( assocList );
   \   000109                ; Setup parameters for call to function osal_mem_free
   \   000109   EE           MOV     A,R6
   \   00010A   FA           MOV     R2,A
   \   00010B   EF           MOV     A,R7
   \   00010C   FB           MOV     R3,A
   \   00010D   12....       LCALL   ??osal_mem_free?relay
    379            }
    380          }
   \                     ??MT_UtilGetDeviceInfo_7:
   \   000110   7401         MOV     A,#0x1
   \   000112   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_59:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   7C00         MOV     R4,#0x0
   \   000002   7D00         MOV     R5,#0x0
   \   000004   7A01         MOV     R2,#0x1
   \   000006                REQUIRE ??Subroutine42_0
   \   000006                ; // Fall through to label ??Subroutine42_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine42_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_read?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 4
   \   000004   85..83       MOV     DPH,?V0 + 5
   \   000007   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine37:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   8582..       MOV     ?V0 + 4,DPL
   \   000005   8583..       MOV     ?V0 + 5,DPH
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F08         MOV     R7,#0x8
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA
    381          
    382          /***************************************************************************************************
    383           * @fn      MT_UtilGetNvInfo
    384           *
    385           * @brief   The Get NV Info serial message.
    386           *
    387           * @param   None.
    388           *
    389           * @return  void
    390           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    391          void MT_UtilGetNvInfo(void)
   \                     MT_UtilGetNvInfo:
    392          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    393            uint8 len;
    394            uint8 stat;
    395            uint8 *buf;
    396            uint8 *pBuf;
    397            uint16 tmp16;
    398            uint32 tmp32;
    399          
    400            /*
    401              Get required length of buffer
    402              Status + ExtAddr + ChanList + PanID  + SecLevel + PreCfgKey
    403            */
    404            len = 1 + Z_EXTADDR_LEN + 4 + 2 + 1 + SEC_KEY_LEN;
    405          
    406            buf = osal_mem_alloc( len );
   \   00000A                ; Setup parameters for call to function osal_mem_alloc
   \   00000A   7A20         MOV     R2,#0x20
   \   00000C   7B00         MOV     R3,#0x0
   \   00000E   12....       LCALL   ??osal_mem_alloc?relay
   \   000011   8A..         MOV     ?V0 + 0,R2
   \   000013   8B..         MOV     ?V0 + 1,R3
   \   000015   AE..         MOV     R6,?V0 + 0
   \   000017   AF..         MOV     R7,?V0 + 1
    407            if ( buf )
   \   000019   EE           MOV     A,R6
   \   00001A   4F           ORL     A,R7
   \   00001B   7003         JNZ     $+5
   \   00001D   02....       LJMP    ??MT_UtilGetNvInfo_0 & 0xFFFF
    408            {
    409              /* Assume NV not available */
    410              osal_memset( buf, 0xFF, len );
   \   000020                ; Setup parameters for call to function osal_memset
   \   000020   7C20         MOV     R4,#0x20
   \   000022   7D00         MOV     R5,#0x0
   \   000024   79FF         MOV     R1,#-0x1
   \   000026   12....       LCALL   ??osal_memset?relay
    411          
    412              /* Skip over status */
    413              pBuf = buf + 1;
   \   000029   8E82         MOV     DPL,R6
   \   00002B   8F83         MOV     DPH,R7
   \   00002D   A3           INC     DPTR
   \   00002E   8582..       MOV     ?V0 + 2,DPL
   \   000031   8583..       MOV     ?V0 + 3,DPH
    414          
    415              /* Start with 64-bit extended address */
    416              stat = osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \   000034                ; Setup parameters for call to function osal_nv_read
   \   000034   78..         MOV     R0,#?V0 + 2
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   75..08       MOV     ?V0 + 0,#0x8
   \   00003C   75..00       MOV     ?V0 + 1,#0x0
   \   00003F   78..         MOV     R0,#?V0 + 0
   \   000041   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000044   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_66:
   \   000047   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004A   E9           MOV     A,R1
   \   00004B   F5..         MOV     ?V0 + 0,A
    417              if ( stat ) stat = 0x01;
   \   00004D   6003         JZ      ??MT_UtilGetNvInfo_1
   \   00004F   75..01       MOV     ?V0 + 0,#0x1
    418              pBuf += Z_EXTADDR_LEN;
   \                     ??MT_UtilGetNvInfo_1:
   \   000052   E5..         MOV     A,?V0 + 2
   \   000054   2408         ADD     A,#0x8
   \   000056   F5..         MOV     ?V0 + 2,A
   \   000058   E5..         MOV     A,?V0 + 3
   \   00005A   3400         ADDC    A,#0x0
   \   00005C   F5..         MOV     ?V0 + 3,A
    419          
    420              /* Scan channel list (bit mask) */
    421              if (  osal_nv_read( ZCD_NV_CHANLIST, 0, sizeof( tmp32 ), &tmp32 ) )
   \   00005E                ; Setup parameters for call to function osal_nv_read
   \   00005E   7402         MOV     A,#0x2
   \   000060   12....       LCALL   ?XSTACK_DISP0_8
   \   000063   8582..       MOV     ?V0 + 4,DPL
   \   000066   8583..       MOV     ?V0 + 5,DPH
   \   000069   78..         MOV     R0,#?V0 + 4
   \   00006B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006E   75..04       MOV     ?V0 + 4,#0x4
   \   000071   75..00       MOV     ?V0 + 5,#0x0
   \   000074   78..         MOV     R0,#?V0 + 4
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079   7C00         MOV     R4,#0x0
   \   00007B   7D00         MOV     R5,#0x0
   \   00007D   7A84         MOV     R2,#-0x7c
   \   00007F   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_67:
   \   000082   12....       LCALL   ?DEALLOC_XSTACK8
   \   000085   E9           MOV     A,R1
   \   000086   6008         JZ      ??MT_UtilGetNvInfo_2
    422                stat |= 0x02;
   \   000088   E5..         MOV     A,?V0 + 0
   \   00008A   D2E1         SETB    0xE0 /* A   */.1
   \   00008C   F5..         MOV     ?V0 + 0,A
   \   00008E   8060         SJMP    ??MT_UtilGetNvInfo_3
    423              else
    424              {
    425                pBuf[0] = BREAK_UINT32( tmp32, 3 );
   \                     ??MT_UtilGetNvInfo_2:
   \   000090   7402         MOV     A,#0x2
   \   000092   12....       LCALL   ?XSTACK_DISP0_8
   \   000095   78..         MOV     R0,#?V0 + 4
   \   000097   12....       LCALL   ?L_MOV_X
   \   00009A   7418         MOV     A,#0x18
   \   00009C   78..         MOV     R0,#?V0 + 4
   \   00009E   12....       LCALL   ?UL_SHR
   \   0000A1   85..82       MOV     DPL,?V0 + 2
   \   0000A4   85..83       MOV     DPH,?V0 + 3
   \   0000A7   E5..         MOV     A,?V0 + 4
   \   0000A9   F0           MOVX    @DPTR,A
    426                pBuf[1] = BREAK_UINT32( tmp32, 2 );
   \   0000AA   7402         MOV     A,#0x2
   \   0000AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AF   78..         MOV     R0,#?V0 + 4
   \   0000B1   12....       LCALL   ?L_MOV_X
   \   0000B4   7410         MOV     A,#0x10
   \   0000B6   78..         MOV     R0,#?V0 + 4
   \   0000B8   12....       LCALL   ?UL_SHR
   \   0000BB   85..82       MOV     DPL,?V0 + 2
   \   0000BE   85..83       MOV     DPH,?V0 + 3
   \   0000C1   A3           INC     DPTR
   \   0000C2   E5..         MOV     A,?V0 + 4
   \   0000C4   F0           MOVX    @DPTR,A
    427                pBuf[2] = BREAK_UINT32( tmp32, 1 );
   \   0000C5   7402         MOV     A,#0x2
   \   0000C7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CA   78..         MOV     R0,#?V0 + 4
   \   0000CC   12....       LCALL   ?L_MOV_X
   \   0000CF   E5..         MOV     A,?V0 + 5
   \   0000D1   85..82       MOV     DPL,?V0 + 2
   \   0000D4   85..83       MOV     DPH,?V0 + 3
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   F0           MOVX    @DPTR,A
    428                pBuf[3] = BREAK_UINT32( tmp32, 0 );
   \   0000DA   7402         MOV     A,#0x2
   \   0000DC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DF   78..         MOV     R0,#?V0 + 4
   \   0000E1   12....       LCALL   ?L_MOV_X
   \   0000E4   85..82       MOV     DPL,?V0 + 2
   \   0000E7   85..83       MOV     DPH,?V0 + 3
   \   0000EA   A3           INC     DPTR
   \   0000EB   A3           INC     DPTR
   \   0000EC   A3           INC     DPTR
   \   0000ED   E5..         MOV     A,?V0 + 4
   \   0000EF   F0           MOVX    @DPTR,A
    429              }
    430              pBuf += sizeof( tmp32 );
   \                     ??MT_UtilGetNvInfo_3:
   \   0000F0   E5..         MOV     A,?V0 + 2
   \   0000F2   2404         ADD     A,#0x4
   \   0000F4   F5..         MOV     ?V0 + 2,A
   \   0000F6   E5..         MOV     A,?V0 + 3
   \   0000F8   3400         ADDC    A,#0x0
   \   0000FA   F5..         MOV     ?V0 + 3,A
    431          
    432              /* ZigBee PanID */
    433              if ( osal_nv_read( ZCD_NV_PANID, 0, sizeof( tmp16 ), &tmp16 ) )
   \   0000FC                ; Setup parameters for call to function osal_nv_read
   \   0000FC   85..82       MOV     DPL,?XSP + 0
   \   0000FF   85..83       MOV     DPH,?XSP + 1
   \   000102   8582..       MOV     ?V0 + 4,DPL
   \   000105   8583..       MOV     ?V0 + 5,DPH
   \   000108   78..         MOV     R0,#?V0 + 4
   \   00010A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00010D   75..02       MOV     ?V0 + 4,#0x2
   \   000110   75..00       MOV     ?V0 + 5,#0x0
   \   000113   78..         MOV     R0,#?V0 + 4
   \   000115   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000118   7C00         MOV     R4,#0x0
   \   00011A   7D00         MOV     R5,#0x0
   \   00011C   7A83         MOV     R2,#-0x7d
   \   00011E   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_68:
   \   000121   12....       LCALL   ?DEALLOC_XSTACK8
   \   000124   E9           MOV     A,R1
   \   000125   6008         JZ      ??MT_UtilGetNvInfo_4
    434                stat |= 0x04;
   \   000127   E5..         MOV     A,?V0 + 0
   \   000129   D2E2         SETB    0xE0 /* A   */.2
   \   00012B   F5..         MOV     ?V0 + 0,A
   \   00012D   801E         SJMP    ??MT_UtilGetNvInfo_5
    435              else
    436              {
    437                pBuf[0] = LO_UINT16( tmp16 );
   \                     ??MT_UtilGetNvInfo_4:
   \   00012F   85..82       MOV     DPL,?XSP + 0
   \   000132   85..83       MOV     DPH,?XSP + 1
   \   000135   E0           MOVX    A,@DPTR
   \   000136   85..82       MOV     DPL,?V0 + 2
   \   000139   85..83       MOV     DPH,?V0 + 3
   \   00013C   F0           MOVX    @DPTR,A
    438                pBuf[1] = HI_UINT16( tmp16 );
   \   00013D   85..82       MOV     DPL,?XSP + 0
   \   000140   85..83       MOV     DPH,?XSP + 1
   \   000143   A3           INC     DPTR
   \   000144   E0           MOVX    A,@DPTR
   \   000145   85..82       MOV     DPL,?V0 + 2
   \   000148   85..83       MOV     DPH,?V0 + 3
   \   00014B   A3           INC     DPTR
   \   00014C   F0           MOVX    @DPTR,A
    439              }
    440              pBuf += sizeof( tmp16 );
   \                     ??MT_UtilGetNvInfo_5:
   \   00014D   E5..         MOV     A,?V0 + 2
   \   00014F   2402         ADD     A,#0x2
   \   000151   F5..         MOV     ?V0 + 2,A
   \   000153   E5..         MOV     A,?V0 + 3
   \   000155   3400         ADDC    A,#0x0
   \   000157   F5..         MOV     ?V0 + 3,A
    441          
    442              /* Security level */
    443              if ( osal_nv_read( ZCD_NV_SECURITY_LEVEL, 0, sizeof( uint8 ), pBuf++ ) )
   \   000159                ; Setup parameters for call to function osal_nv_read
   \   000159   78..         MOV     R0,#?V0 + 2
   \   00015B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00015E   75..01       MOV     ?V0 + 4,#0x1
   \   000161   78..         MOV     R0,#?V0 + 4
   \   000163   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000166   7C00         MOV     R4,#0x0
   \   000168   7D00         MOV     R5,#0x0
   \   00016A   7A61         MOV     R2,#0x61
   \   00016C   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_69:
   \   00016F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000172   E9           MOV     A,R1
   \   000173   85..82       MOV     DPL,?V0 + 2
   \   000176   85..83       MOV     DPH,?V0 + 3
   \   000179   A3           INC     DPTR
   \   00017A   8582..       MOV     ?V0 + 2,DPL
   \   00017D   8583..       MOV     ?V0 + 3,DPH
   \   000180   6006         JZ      ??MT_UtilGetNvInfo_6
    444                stat |= 0x08;
   \   000182   E5..         MOV     A,?V0 + 0
   \   000184   D2E3         SETB    0xE0 /* A   */.3
   \   000186   F5..         MOV     ?V0 + 0,A
    445          
    446              /* Pre-configured security key */
    447              if ( osal_nv_read( ZCD_NV_PRECFGKEY, 0, SEC_KEY_LEN, pBuf ) )
   \                     ??MT_UtilGetNvInfo_6:
   \   000188                ; Setup parameters for call to function osal_nv_read
   \   000188   78..         MOV     R0,#?V0 + 2
   \   00018A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00018D   75..10       MOV     ?V0 + 2,#0x10
   \   000190   75..00       MOV     ?V0 + 3,#0x0
   \   000193   78..         MOV     R0,#?V0 + 2
   \   000195   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000198   7C00         MOV     R4,#0x0
   \   00019A   7D00         MOV     R5,#0x0
   \   00019C   7A62         MOV     R2,#0x62
   \   00019E   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_70:
   \   0001A1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001A4   E9           MOV     A,R1
   \   0001A5   6006         JZ      ??MT_UtilGetNvInfo_7
    448                stat |= 0x10;
   \   0001A7   E5..         MOV     A,?V0 + 0
   \   0001A9   D2E4         SETB    0xE0 /* A   */.4
   \   0001AB   F5..         MOV     ?V0 + 0,A
    449          
    450              /* Status bit mask - bit=1 indicates failure */
    451              *buf = stat;
   \                     ??MT_UtilGetNvInfo_7:
   \   0001AD   8E82         MOV     DPL,R6
   \   0001AF   8F83         MOV     DPH,R7
   \   0001B1   E5..         MOV     A,?V0 + 0
   \   0001B3   F0           MOVX    @DPTR,A
    452          
    453              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), MT_UTIL_GET_NV_INFO,
    454                                            len, buf );
   \   0001B4                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001B4   EE           MOV     A,R6
   \   0001B5   FC           MOV     R4,A
   \   0001B6   EF           MOV     A,R7
   \   0001B7   FD           MOV     R5,A
   \   0001B8   7B20         MOV     R3,#0x20
   \   0001BA   7A01         MOV     R2,#0x1
   \   0001BC   7967         MOV     R1,#0x67
   \   0001BE   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    455          
    456              osal_mem_free( buf );
   \   0001C1                ; Setup parameters for call to function osal_mem_free
   \   0001C1   EE           MOV     A,R6
   \   0001C2   FA           MOV     R2,A
   \   0001C3   EF           MOV     A,R7
   \   0001C4   FB           MOV     R3,A
   \   0001C5   12....       LCALL   ??osal_mem_free?relay
    457            }
    458          }
   \                     ??MT_UtilGetNvInfo_0:
   \   0001C8   7406         MOV     A,#0x6
   \   0001CA   02....       LJMP    ?Subroutine0 & 0xFFFF
    459          
    460          /***************************************************************************************************
    461           * @fn      MT_UtilSetPanID
    462           *
    463           * @brief   Set PanID message
    464           *
    465           * @param   pBuf - pointer to the data
    466           *
    467           * @return  void
    468           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    469          void MT_UtilSetPanID(uint8 *pBuf)
   \                     MT_UtilSetPanID:
    470          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    471            uint16 temp16;
    472            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine25 & 0xFFFF
    473            uint8 cmdId;
    474          
    475            /* parse header */
    476            cmdId = pBuf[MT_RPC_POS_CMD1];
    477            pBuf += MT_RPC_FRAME_HDR_SZ;
   \                     ??CrossCallReturnLabel_33:
   \   00000D   12....       LCALL   ?Subroutine12 & 0xFFFF
    478          
    479            temp16 = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_12:
   \   000010   F8           MOV     R0,A
   \   000011   7401         MOV     A,#0x1
   \   000013   12....       LCALL   ?XSTACK_DISP0_8
   \   000016   E8           MOV     A,R0
   \   000017   F0           MOVX    @DPTR,A
   \   000018   A3           INC     DPTR
   \   000019   E9           MOV     A,R1
   \   00001A   F0           MOVX    @DPTR,A
    480            pBuf += sizeof(uint16);
    481          
    482            retValue = osal_nv_write(ZCD_NV_PANID, 0, osal_nv_item_len( ZCD_NV_PANID ), &temp16);
   \   00001B                ; Setup parameters for call to function osal_nv_write
   \   00001B   7401         MOV     A,#0x1
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   8582..       MOV     ?V0 + 0,DPL
   \   000023   8583..       MOV     ?V0 + 1,DPH
   \   000026   78..         MOV     R0,#?V0 + 0
   \   000028   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002B                ; Setup parameters for call to function osal_nv_item_len
   \   00002B   7A83         MOV     R2,#-0x7d
   \   00002D   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   000030   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000033   7C00         MOV     R4,#0x0
   \   000035   7D00         MOV     R5,#0x0
   \   000037   7A83         MOV     R2,#-0x7d
   \   000039   7B00         MOV     R3,#0x0
   \   00003B   12....       LCALL   ??osal_nv_write?relay
   \   00003E   7404         MOV     A,#0x4
   \   000040   12....       LCALL   ?DEALLOC_XSTACK8
   \   000043   12....       LCALL   ?Subroutine19 & 0xFFFF
    483          
    484            /* Build and send back the response */
    485            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
    486          }
   \                     ??CrossCallReturnLabel_26:
   \   000046   7403         MOV     A,#0x3
   \   000048   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_56:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   7401         MOV     A,#0x1
   \   000008   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_60:
   \   00000B   FE           MOV     R6,A
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   E9           MOV     A,R1
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   F0           MOVX    @DPTR,A
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008   AC82         MOV     R4,DPL
   \   00000A   AD83         MOV     R5,DPH
   \   00000C   7B01         MOV     R3,#0x1
   \   00000E   EE           MOV     A,R6
   \   00000F   FA           MOV     R2,A
   \   000010   7967         MOV     R1,#0x67
   \   000012   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000015   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine43_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F02         MOV     R7,#0x2
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_item_len?relay
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   78..         MOV     R0,#?V0 + 0
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   12....       LCALL   ?Subroutine32 & 0xFFFF
   \                     ??CrossCallReturnLabel_49:
   \   000003   FC           MOV     R4,A
   \   000004   A3           INC     DPTR
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   EC           MOV     A,R4
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   EA           MOV     A,R2
   \   000001   2403         ADD     A,#0x3
   \   000003   0A           INC     R2
   \   000004   0A           INC     R2
   \   000005   0A           INC     R2
   \   000006   EB           MOV     A,R3
   \   000007   3400         ADDC    A,#0x0
   \   000009   FB           MOV     R3,A
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine39:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   E0           MOVX    A,@DPTR
   \   000008   22           RET
    487          
    488          /***************************************************************************************************
    489           * @fn      MT_UtilSetChannels
    490           *
    491           * @brief   Set Channels
    492           *
    493           * @param   pBuf - pointer to the data
    494           *
    495           * @return  void
    496           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    497          void MT_UtilSetChannels(uint8 *pBuf)
   \                     MT_UtilSetChannels:
    498          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    499            uint32 tmp32;
    500            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine25 & 0xFFFF
    501            uint8 cmdId;
    502          
    503            /* parse header */
    504            cmdId = pBuf[MT_RPC_POS_CMD1];
    505            pBuf += MT_RPC_FRAME_HDR_SZ;
   \                     ??CrossCallReturnLabel_34:
   \   00000D   12....       LCALL   ?Subroutine32 & 0xFFFF
    506          
    507            tmp32 = BUILD_UINT32(pBuf[0], pBuf[1], pBuf[2], pBuf[3]);
   \                     ??CrossCallReturnLabel_48:
   \   000010   F5..         MOV     ?V0 + 0,A
   \   000012   E4           CLR     A
   \   000013   F5..         MOV     ?V0 + 1,A
   \   000015   F5..         MOV     ?V0 + 2,A
   \   000017   F5..         MOV     ?V0 + 3,A
   \   000019   A3           INC     DPTR
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F5..         MOV     ?V0 + 4,A
   \   00001D   E4           CLR     A
   \   00001E   F5..         MOV     ?V0 + 5,A
   \   000020   F5..         MOV     ?V0 + 6,A
   \   000022   F5..         MOV     ?V0 + 7,A
   \   000024   7408         MOV     A,#0x8
   \   000026   78..         MOV     R0,#?V0 + 4
   \   000028   12....       LCALL   ?L_SHL
   \   00002B   78..         MOV     R0,#?V0 + 0
   \   00002D   79..         MOV     R1,#?V0 + 4
   \   00002F   12....       LCALL   ?L_ADD
   \   000032   8A82         MOV     DPL,R2
   \   000034   8B83         MOV     DPH,R3
   \   000036   A3           INC     DPTR
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F5..         MOV     ?V0 + 4,A
   \   00003B   E4           CLR     A
   \   00003C   F5..         MOV     ?V0 + 5,A
   \   00003E   7410         MOV     A,#0x10
   \   000040   78..         MOV     R0,#?V0 + 4
   \   000042   12....       LCALL   ?L_SHL
   \   000045   78..         MOV     R0,#?V0 + 0
   \   000047   79..         MOV     R1,#?V0 + 4
   \   000049   12....       LCALL   ?L_ADD
   \   00004C   8A82         MOV     DPL,R2
   \   00004E   8B83         MOV     DPH,R3
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   E0           MOVX    A,@DPTR
   \   000054   F5..         MOV     ?V0 + 4,A
   \   000056   E4           CLR     A
   \   000057   F5..         MOV     ?V0 + 6,A
   \   000059   7418         MOV     A,#0x18
   \   00005B   78..         MOV     R0,#?V0 + 4
   \   00005D   12....       LCALL   ?L_SHL
   \   000060   78..         MOV     R0,#?V0 + 0
   \   000062   79..         MOV     R1,#?V0 + 4
   \   000064   12....       LCALL   ?L_ADD
   \   000067   7401         MOV     A,#0x1
   \   000069   12....       LCALL   ?XSTACK_DISP0_8
   \   00006C   78..         MOV     R0,#?V0 + 0
   \   00006E   12....       LCALL   ?L_MOV_TO_X
    508          
    509            retValue = osal_nv_write(ZCD_NV_CHANLIST, 0, osal_nv_item_len( ZCD_NV_CHANLIST ), &tmp32);
   \   000071                ; Setup parameters for call to function osal_nv_write
   \   000071   7401         MOV     A,#0x1
   \   000073   12....       LCALL   ?XSTACK_DISP0_8
   \   000076   8582..       MOV     ?V0 + 0,DPL
   \   000079   8583..       MOV     ?V0 + 1,DPH
   \   00007C   78..         MOV     R0,#?V0 + 0
   \   00007E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000081                ; Setup parameters for call to function osal_nv_item_len
   \   000081   7A84         MOV     R2,#-0x7c
   \   000083   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_41:
   \   000086   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000089   7C00         MOV     R4,#0x0
   \   00008B   7D00         MOV     R5,#0x0
   \   00008D   7A84         MOV     R2,#-0x7c
   \   00008F   7B00         MOV     R3,#0x0
   \   000091   12....       LCALL   ??osal_nv_write?relay
   \   000094   7404         MOV     A,#0x4
   \   000096   12....       LCALL   ?DEALLOC_XSTACK8
   \   000099   12....       LCALL   ?Subroutine19 & 0xFFFF
    510          
    511            /* Build and send back the response */
    512            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
    513          }
   \                     ??CrossCallReturnLabel_27:
   \   00009C   7405         MOV     A,#0x5
   \   00009E                REQUIRE ?Subroutine0
   \   00009E                ; // Fall through to label ?Subroutine0
    514          
    515          /***************************************************************************************************
    516           * @fn      MT_UtilSetSecLevel
    517           *
    518           * @brief   Set Sec Level
    519           *
    520           * @param   byte *msg - pointer to the data
    521           *
    522           * @return  void
    523           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    524          void MT_UtilSetSecLevel(uint8 *pBuf)
   \                     MT_UtilSetSecLevel:
    525          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    526            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
    527            uint8 cmdId;
    528          
    529            /* parse header */
    530            cmdId = pBuf[MT_RPC_POS_CMD1];
    531            pBuf += MT_RPC_FRAME_HDR_SZ;
    532          
    533            retValue = osal_nv_write( ZCD_NV_SECURITY_LEVEL, 0, osal_nv_item_len( ZCD_NV_SECURITY_LEVEL ), pBuf);
   \                     ??CrossCallReturnLabel_14:
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010                ; Setup parameters for call to function osal_nv_item_len
   \   000010   7A61         MOV     R2,#0x61
   \   000012   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_42:
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   7A61         MOV     R2,#0x61
   \   00001E                REQUIRE ?Subroutine1
   \   00001E                ; // Fall through to label ?Subroutine1
    534          
    535            /* Build and send back the response */
    536            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    537          
    538          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_write?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   12....       LCALL   ?DEALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_28:
   \   00000D   7401         MOV     A,#0x1
   \   00000F                REQUIRE ??Subroutine43_0
   \   00000F                ; // Fall through to label ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_57:
   \   000003                ; Setup parameters for call to function osal_nv_write
   \   000003                ; Setup parameters for call to function osal_nv_write
   \   000003   EA           MOV     A,R2
   \   000004   2403         ADD     A,#0x3
   \   000006   F5..         MOV     ?V0 + 0,A
   \   000008   EB           MOV     A,R3
   \   000009   3400         ADDC    A,#0x0
   \   00000B   F5..         MOV     ?V0 + 1,A
   \   00000D   78..         MOV     R0,#?V0 + 0
   \   00000F   22           RET
    539          
    540          /***************************************************************************************************
    541           * @fn      MT_UtilSetPreCfgKey
    542           *
    543           * @brief   Set Pre Cfg Key
    544           *
    545           * @param   pBuf - pointer to the data
    546           *
    547           * @return  void
    548           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    549          void MT_UtilSetPreCfgKey(uint8 *pBuf)
   \                     MT_UtilSetPreCfgKey:
    550          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    551            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
    552            uint8 cmdId;
    553          
    554            /* parse header */
    555            cmdId = pBuf[MT_RPC_POS_CMD1];
    556            pBuf += MT_RPC_FRAME_HDR_SZ;
    557          
    558            retValue = osal_nv_write( ZCD_NV_PRECFGKEY, 0, osal_nv_item_len( ZCD_NV_PRECFGKEY ), pBuf);
   \                     ??CrossCallReturnLabel_15:
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010                ; Setup parameters for call to function osal_nv_item_len
   \   000010   7A62         MOV     R2,#0x62
   \   000012   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   7A62         MOV     R2,#0x62
   \   00001E   80..         SJMP    ?Subroutine1
    559          
    560            /* Build and send back the response */
    561            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    562          
    563          }
    564          
    565          /***************************************************************************************************
    566           * @fn      MT_UtilCallbackSub
    567           *
    568           * @brief   The Callback subscribe.
    569           *
    570           * @param   pBuf - pointer to the data
    571           *
    572           * @return  void
    573           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    574          void MT_UtilCallbackSub(uint8 *pBuf)
   \                     MT_UtilCallbackSub:
    575          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    576            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   FE           MOV     R6,A
    577            uint8 retValue = ZFailure;
    578          
    579          #if defined(MT_MAC_CB_FUNC) || defined(MT_NWK_CB_FUNC) || defined(MT_ZDO_CB_FUNC) || defined(MT_AF_CB_FUNC) || defined(MT_SAPI_CB_FUNC)
    580            uint8 subSystem;
    581            uint16 subscribed_command;
    582          
    583            // Move past header
    584            retValue = ZSuccess;
   \   000012   85..82       MOV     DPL,?XSP + 0
   \   000015   85..83       MOV     DPH,?XSP + 1
   \   000018   E4           CLR     A
   \   000019   F0           MOVX    @DPTR,A
    585            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001A   12....       LCALL   ?Subroutine12 & 0xFFFF
    586          
    587            /* Command */
    588            subscribed_command = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_13:
   \   00001D   2400         ADD     A,#0x0
   \   00001F   F8           MOV     R0,A
   \   000020   E4           CLR     A
   \   000021   39           ADDC    A,R1
    589            pBuf += 2;
    590          
    591            /* Subsystem - 5 bits on the MSB of the command */
    592            subSystem = HI_UINT16(subscribed_command) & 0x1F ;
   \   000022   541F         ANL     A,#0x1f
   \   000024   FF           MOV     R7,A
    593          
    594            /* What is the action - SUBSCRIBE or !SUBSCRIBE */
    595            if (*pBuf)
   \   000025   8A82         MOV     DPL,R2
   \   000027   8B83         MOV     DPH,R3
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   6031         JZ      ??MT_UtilCallbackSub_0
    596            {
    597              /* Turn ON */
    598            #if defined( MT_MAC_CB_FUNC )
    599              if ((subSystem == MT_RPC_SYS_MAC) || (subscribed_command == 0xFFFF))
    600                _macCallbackSub = 0xFFFF;
    601            #endif
    602          
    603            #if defined( MT_NWK_CB_FUNC )
    604              if ((subSystem == MT_RPC_SYS_NWK) || (subscribed_command == 0xFFFF))
    605                _nwkCallbackSub = 0xFFFF;
    606            #endif
    607          
    608            #if defined( MT_ZDO_CB_FUNC )
    609              if ((subSystem == MT_RPC_SYS_ZDO) || (subscribed_command == 0xFFFF))
   \   00002E   7405         MOV     A,#0x5
   \   000030   6F           XRL     A,R7
   \   000031   600A         JZ      ??MT_UtilCallbackSub_1
   \   000033   74FF         MOV     A,#-0x1
   \   000035   68           XRL     A,R0
   \   000036   7003         JNZ     ??MT_UtilCallbackSub_2
   \   000038   74FF         MOV     A,#-0x1
   \   00003A   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_2:
   \   00003B   700C         JNZ     ??MT_UtilCallbackSub_3
    610                _zdoCallbackSub = 0xFFFFFFFF;
   \                     ??MT_UtilCallbackSub_1:
   \   00003D   90....       MOV     DPTR,#__Constant_ffffffff
   \   000040   12....       LCALL   ?XLOAD_R2345
   \   000043   90....       MOV     DPTR,#_zdoCallbackSub
   \   000046   12....       LCALL   ?XSTORE_R2345
    611            #endif
    612          
    613            #if defined( MT_AF_CB_FUNC )
    614              if ((subSystem == MT_RPC_SYS_AF) || (subscribed_command == 0xFFFF))
    615                _afCallbackSub = 0xFFFF;
    616            #endif
    617          
    618            #if defined( MT_SAPI_CB_FUNC )
    619              if ((subSystem == MT_RPC_SYS_SAPI) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_3:
   \   000049   7406         MOV     A,#0x6
   \   00004B   6F           XRL     A,R7
   \   00004C   600A         JZ      ??MT_UtilCallbackSub_4
   \   00004E   74FF         MOV     A,#-0x1
   \   000050   68           XRL     A,R0
   \   000051   7003         JNZ     ??MT_UtilCallbackSub_5
   \   000053   74FF         MOV     A,#-0x1
   \   000055   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_5:
   \   000056   7038         JNZ     ??MT_UtilCallbackSub_6
    620                _sapiCallbackSub = 0xFFFF;
   \                     ??MT_UtilCallbackSub_4:
   \   000058   90....       MOV     DPTR,#_sapiCallbackSub
   \   00005B   74FF         MOV     A,#-0x1
   \   00005D   802E         SJMP    ??MT_UtilCallbackSub_7
    621            #endif
    622            }
    623            else
    624            {
    625              /* Turn OFF */
    626            #if defined( MT_MAC_CB_FUNC )
    627              if ((subSystem == MT_RPC_SYS_MAC) || (subscribed_command == 0xFFFF))
    628                _macCallbackSub = 0x0000;
    629            #endif
    630          
    631            #if defined( MT_NWK_CB_FUNC )
    632              if ((subSystem == MT_RPC_SYS_NWK) || (subscribed_command == 0xFFFF))
    633                _nwkCallbackSub = 0x0000;
    634            #endif
    635          
    636            #if defined( MT_ZDO_CB_FUNC )
    637              if ((subSystem == MT_RPC_SYS_ZDO) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_0:
   \   00005F   7405         MOV     A,#0x5
   \   000061   6F           XRL     A,R7
   \   000062   600A         JZ      ??MT_UtilCallbackSub_8
   \   000064   74FF         MOV     A,#-0x1
   \   000066   68           XRL     A,R0
   \   000067   7003         JNZ     ??MT_UtilCallbackSub_9
   \   000069   74FF         MOV     A,#-0x1
   \   00006B   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_9:
   \   00006C   700C         JNZ     ??MT_UtilCallbackSub_10
    638                _zdoCallbackSub = 0x00000000;
   \                     ??MT_UtilCallbackSub_8:
   \   00006E   90....       MOV     DPTR,#__Constant_0
   \   000071   12....       LCALL   ?XLOAD_R2345
   \   000074   90....       MOV     DPTR,#_zdoCallbackSub
   \   000077   12....       LCALL   ?XSTORE_R2345
    639            #endif
    640          
    641            #if defined( MT_AF_CB_FUNC )
    642              if ((subSystem == MT_RPC_SYS_AF) || (subscribed_command == 0xFFFF))
    643                _afCallbackSub = 0x0000;
    644            #endif
    645          
    646            #if defined( MT_SAPI_CB_FUNC )
    647              if ((subSystem == MT_RPC_SYS_SAPI) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_10:
   \   00007A   7406         MOV     A,#0x6
   \   00007C   6F           XRL     A,R7
   \   00007D   600A         JZ      ??MT_UtilCallbackSub_11
   \   00007F   74FF         MOV     A,#-0x1
   \   000081   68           XRL     A,R0
   \   000082   7003         JNZ     ??MT_UtilCallbackSub_12
   \   000084   74FF         MOV     A,#-0x1
   \   000086   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_12:
   \   000087   7007         JNZ     ??MT_UtilCallbackSub_6
    648                  _sapiCallbackSub = 0x0000;
   \                     ??MT_UtilCallbackSub_11:
   \   000089   90....       MOV     DPTR,#_sapiCallbackSub
   \   00008C   E4           CLR     A
   \                     ??MT_UtilCallbackSub_7:
   \   00008D   F0           MOVX    @DPTR,A
   \   00008E   A3           INC     DPTR
   \   00008F   F0           MOVX    @DPTR,A
    649            #endif
    650            }
    651          #endif  // MT_MAC_CB_FUNC || MT_NWK_CB_FUNC || MT_ZDO_CB_FUNC || MT_AF_CB_FUNC || MT_SAPI_CB_FUNC || MT_SAPI_CB_FUNC
    652          
    653            /* Build and send back the response */
    654            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??MT_UtilCallbackSub_6:
   \   000090                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000090   85..82       MOV     DPL,?XSP + 0
   \   000093   85..83       MOV     DPH,?XSP + 1
   \   000096   AC82         MOV     R4,DPL
   \   000098   AD83         MOV     R5,DPH
   \   00009A   7B01         MOV     R3,#0x1
   \   00009C   EE           MOV     A,R6
   \   00009D   FA           MOV     R2,A
   \   00009E   7967         MOV     R1,#0x67
   \   0000A0   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    655          }
   \   0000A3   7401         MOV     A,#0x1
   \   0000A5   02....       LJMP    ??Subroutine46_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine46_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F01         MOV     R7,#0x1
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA
    656          
    657          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    658          /***************************************************************************************************
    659           * @fn      MT_UtilKeyEvent
    660           *
    661           * @brief   Process Key Event
    662           *
    663           * @param   pBuf - pointer to the data
    664           *
    665           * @return  void
    666           ***************************************************************************************************/
    667          void MT_UtilKeyEvent(uint8 *pBuf)
    668          {
    669            uint8 x = 0;
    670            uint8 retValue = ZFailure;
    671            uint8 cmdId;
    672          
    673            /* parse header */
    674            cmdId = pBuf[MT_RPC_POS_CMD1];
    675            pBuf += MT_RPC_FRAME_HDR_SZ;
    676          
    677            /* Translate between SPI values to device values */
    678            if ( *pBuf & 0x01 )
    679              x |= HAL_KEY_SW_1;
    680            if ( *pBuf & 0x02 )
    681              x |= HAL_KEY_SW_2;
    682            if ( *pBuf & 0x04 )
    683              x |= HAL_KEY_SW_3;
    684            if ( *pBuf & 0x08 )
    685            x |= HAL_KEY_SW_4;
    686          #if defined ( HAL_KEY_SW_5 )
    687            if ( *pBuf & 0x10 )
    688              x |= HAL_KEY_SW_5;
    689          #endif
    690          #if defined ( HAL_KEY_SW_6 )
    691            if ( *pBuf & 0x20 )
    692              x |= HAL_KEY_SW_6;
    693          #endif
    694          #if defined ( HAL_KEY_SW_7 )
    695            if ( *pBuf & 0x40 )
    696              x |= HAL_KEY_SW_7;
    697          #endif
    698          #if defined ( HAL_KEY_SW_8 )
    699            if ( *pBuf & 0x80 )
    700              x |= HAL_KEY_SW_8;
    701          #endif
    702            pBuf++;
    703          
    704            retValue = OnBoard_SendKeys(x, *pBuf);
    705          
    706            /* Build and send back the response */
    707            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    708          }
    709          #endif
    710          
    711          /***************************************************************************************************
    712           * @fn      MT_UtilTimeAlive
    713           *
    714           * @brief   Process Time Alive
    715           *
    716           * @param   None.
    717           *
    718           * @return  None
    719           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    720          void MT_UtilTimeAlive(void)
   \                     MT_UtilTimeAlive:
    721          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    722            uint8 timeAlive[4];
    723            uint32 tmp32;
    724          
    725            /* Time since last reset (seconds) */
    726            tmp32 = osal_GetSystemClock() / 1000;
   \   00000A                ; Setup parameters for call to function osal_GetSystemClock
   \   00000A   12....       LCALL   ??osal_GetSystemClock?relay
   \   00000D   8A..         MOV     ?V0 + 4,R2
   \   00000F   8B..         MOV     ?V0 + 5,R3
   \   000011   8C..         MOV     ?V0 + 6,R4
   \   000013   8D..         MOV     ?V0 + 7,R5
   \   000015   90....       MOV     DPTR,#__Constant_3e8
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?L_MOV_X
   \   00001D   78..         MOV     R0,#?V0 + 4
   \   00001F   79..         MOV     R1,#?V0 + 0
   \   000021   12....       LCALL   ?UL_DIV_MOD
    727          
    728            /* Convert to high byte first into temp buffer */
    729            timeAlive[0] = BREAK_UINT32(tmp32, 0);
   \   000024   85..82       MOV     DPL,?XSP + 0
   \   000027   85..83       MOV     DPH,?XSP + 1
   \   00002A   E5..         MOV     A,?V0 + 4
   \   00002C   F0           MOVX    @DPTR,A
    730            timeAlive[1] = BREAK_UINT32(tmp32, 1);
   \   00002D   85....       MOV     ?V0 + 1,?V0 + 5
   \   000030   E5..         MOV     A,?V0 + 1
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   7401         MOV     A,#0x1
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   E5..         MOV     A,?V0 + 0
   \   00003B   F0           MOVX    @DPTR,A
    731            timeAlive[2] = BREAK_UINT32(tmp32, 2);
   \   00003C   85....       MOV     ?V0 + 0,?V0 + 4
   \   00003F   85....       MOV     ?V0 + 2,?V0 + 6
   \   000042   85....       MOV     ?V0 + 3,?V0 + 7
   \   000045   7410         MOV     A,#0x10
   \   000047   78..         MOV     R0,#?V0 + 0
   \   000049   12....       LCALL   ?UL_SHR
   \   00004C   7402         MOV     A,#0x2
   \   00004E   12....       LCALL   ?XSTACK_DISP0_8
   \   000051   E5..         MOV     A,?V0 + 0
   \   000053   F0           MOVX    @DPTR,A
    732            timeAlive[3] = BREAK_UINT32(tmp32, 3);
   \   000054   7418         MOV     A,#0x18
   \   000056   78..         MOV     R0,#?V0 + 4
   \   000058   12....       LCALL   ?UL_SHR
   \   00005B   7403         MOV     A,#0x3
   \   00005D   12....       LCALL   ?XSTACK_DISP0_8
   \   000060   E5..         MOV     A,?V0 + 4
   \   000062   12....       LCALL   ?Subroutine24 & 0xFFFF
    733          
    734            /* Build and send back the response */
    735            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
    736                                                 MT_UTIL_TIME_ALIVE, sizeof(timeAlive), timeAlive);
   \                     ??CrossCallReturnLabel_31:
   \   000065   7B04         MOV     R3,#0x4
   \   000067   7A09         MOV     R2,#0x9
   \   000069   7967         MOV     R1,#0x67
   \   00006B   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    737          }
   \   00006E   7404         MOV     A,#0x4
   \   000070   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_55:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AC82         MOV     R4,DPL
   \   000009   AD83         MOV     R5,DPH
   \   00000B   22           RET
    738          
    739          #if (defined HAL_LED) && (HAL_LED == TRUE)
    740          /***************************************************************************************************
    741           * @fn      MT_UtilLedControl
    742           *
    743           * @brief   Process the LED Control Message
    744           *
    745           * @param   pBuf - pointer to the received data
    746           *
    747           * @return  None
    748           ***************************************************************************************************/
    749          void MT_UtilLedControl(uint8 *pBuf)
    750          {
    751            uint8 iLed, Led, iMode, Mode, cmdId;
    752            uint8 retValue = ZFailure;
    753          
    754            /* parse header */
    755            cmdId = pBuf[MT_RPC_POS_CMD1];
    756            pBuf += MT_RPC_FRAME_HDR_SZ;
    757          
    758            /* LED and Mode */
    759            iLed = *pBuf++;
    760            iMode = *pBuf;
    761          
    762            if ( iLed == 1 )
    763              Led = HAL_LED_1;
    764            else if ( iLed == 2 )
    765              Led = HAL_LED_2;
    766            else if ( iLed == 3 )
    767              Led = HAL_LED_3;
    768            else if ( iLed == 4 )
    769              Led = HAL_LED_4;
    770            else if ( iLed == 0xFF )
    771              Led = HAL_LED_ALL;
    772            else
    773              Led = 0;
    774          
    775            if ( iMode == 0 )
    776              Mode = HAL_LED_MODE_OFF;
    777            else if ( iMode == 1 )
    778              Mode = HAL_LED_MODE_ON;
    779            else if ( iMode == 2 )
    780              Mode = HAL_LED_MODE_BLINK;
    781            else if ( iMode == 3 )
    782              Mode = HAL_LED_MODE_FLASH;
    783            else if ( iMode == 4 )
    784              Mode = HAL_LED_MODE_TOGGLE;
    785            else
    786              Led = 0;
    787          
    788            if ( Led != 0 )
    789            {
    790              HalLedSet (Led, Mode);
    791              retValue = ZSuccess;
    792            }
    793          
    794            /* Build and send back the response */
    795            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    796          }
    797          #endif /* HAL_LED */
    798          
    799          
    800          /***************************************************************************************************
    801           * @fn          MT_UtilSrcMatchEnable
    802           *
    803           * @brief      Enabled AUTOPEND and source address matching.
    804           *
    805           * @param      pBuf - Buffer contains the data
    806           *
    807           * @return     void
    808           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine41_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001   AC82         MOV     R4,DPL
   \   000003   AD83         MOV     R5,DPH
   \   000005   7B01         MOV     R3,#0x1
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    809          void MT_UtilSrcMatchEnable (uint8 *pBuf)
   \                     MT_UtilSrcMatchEnable:
   \   000000   80..         SJMP    ?Subroutine3

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
    810          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004   74FF         MOV     A,#-0x1
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    811            uint8 retValue, cmdId;
    812          
    813            /* Parse header */
    814            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000009   12....       LCALL   ?Subroutine33 & 0xFFFF
    815            pBuf += MT_RPC_FRAME_HDR_SZ;
    816          
    817          #ifdef AUTO_PEND
    818            /* Call the routine */
    819            retValue = ZMacSrcMatchEnable (pBuf[0], pBuf[1]);
    820          #else
    821            retValue = ZMacUnsupported;
   \                     ??CrossCallReturnLabel_51:
   \   00000C   12....       LCALL   ??Subroutine41_0 & 0xFFFF
    822          #endif
    823          
    824            /* Build and send back the response */
    825            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??CrossCallReturnLabel_64:
   \   00000F                REQUIRE ??Subroutine44_0
   \   00000F                ; // Fall through to label ??Subroutine44_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine44_0:
   \   000000   7967         MOV     R1,#0x67
   \   000002   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    826          
    827          }
   \   000005   7401         MOV     A,#0x1
   \   000007                REQUIRE ??Subroutine45_0
   \   000007                ; // Fall through to label ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   D083         POP     DPH
   \   000005   D082         POP     DPL
   \   000007   02....       LJMP    ?BRET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FA           MOV     R2,A
   \   000008   85..82       MOV     DPL,?XSP + 0
   \   00000B   85..83       MOV     DPH,?XSP + 1
   \   00000E   74F5         MOV     A,#-0xb
   \   000010   22           RET
    828          
    829          /***************************************************************************************************
    830           * @fn          MT_UtilSrcMatchAddEntry
    831           *
    832           * @brief       Add a short or extended address to source address table.
    833           *
    834           * @param       pBuf - Buffer contains the data
    835           *
    836           * @return      void
    837           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    838          void MT_UtilSrcMatchAddEntry (uint8 *pBuf)
   \                     MT_UtilSrcMatchAddEntry:
   \   000000   80..         SJMP    ?Subroutine3
    839          {
    840            uint8 retValue, cmdId;
    841          
    842            /* Parse header */
    843            cmdId = pBuf[MT_RPC_POS_CMD1];
    844            pBuf += MT_RPC_FRAME_HDR_SZ;
    845          
    846          #ifdef AUTO_PEND
    847            uint16 panID;
    848            zAddrType_t devAddr;
    849          
    850            /* Address mode */
    851            devAddr.addrMode = *pBuf++;
    852          
    853            /* Address based on the address mode */
    854            MT_UtilSpi2Addr( &devAddr, pBuf);
    855            pBuf += Z_EXTADDR_LEN;
    856          
    857            /* PanID */
    858            panID = BUILD_UINT16( pBuf[0] , pBuf[1] );
    859          
    860            /* Call the routine */
    861            retValue =  ZMacSrcMatchAddEntry (&devAddr, panID);
    862          #else
    863            retValue = ZMacUnsupported;
    864          #endif
    865          
    866            /* Build and send back the response */
    867            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    868          }
    869          
    870          /***************************************************************************************************
    871           * @fn          MT_UtilSrcMatchDeleteEntry
    872           *
    873           * @brief      Delete a short or extended address from source address table.
    874           *
    875           * @param      pBuf - Buffer contains the data
    876           *
    877           * @return     void
    878           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    879          void MT_UtilSrcMatchDeleteEntry (uint8 *pBuf)
   \                     MT_UtilSrcMatchDeleteEntry:
   \   000000   80..         SJMP    ?Subroutine3
    880          {
    881            uint8 retValue, cmdId;
    882          
    883            /* Parse header */
    884            cmdId = pBuf[MT_RPC_POS_CMD1];
    885            pBuf += MT_RPC_FRAME_HDR_SZ;
    886          
    887          #ifdef AUTO_PEND
    888            uint16 panID;
    889            zAddrType_t devAddr;
    890          
    891            /* Address mode */
    892            devAddr.addrMode = *pBuf++;
    893          
    894            /* Address based on the address mode */
    895            MT_UtilSpi2Addr( &devAddr, pBuf);
    896            pBuf += Z_EXTADDR_LEN;
    897          
    898            /* PanID */
    899            panID = BUILD_UINT16( pBuf[0] , pBuf[1] );
    900          
    901            /* Call the routine */
    902            retValue =  ZMacSrcMatchDeleteEntry (&devAddr, panID);
    903          #else
    904            retValue = ZMacUnsupported;
    905          #endif
    906          
    907            /* Build and send back the response */
    908            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    909          }
    910          
    911          /***************************************************************************************************
    912           * @fn          MT_UtilSrcMatchCheckSrcAddr
    913           *
    914           * @brief      Check if a short or extended address is in the source address table.
    915           *
    916           * @param      pBuf - Buffer contains the data
    917           *
    918           * @return     void
    919           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    920          void MT_UtilSrcMatchCheckSrcAddr (uint8 *pBuf)
   \                     MT_UtilSrcMatchCheckSrcAddr:
    921          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 2
   \   000004   74FE         MOV     A,#-0x2
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    922            uint8 cmdId;
    923            uint8 retArray[2];
    924          
    925            /* Parse header */
    926            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000009   12....       LCALL   ?Subroutine15 & 0xFFFF
    927            pBuf += MT_RPC_FRAME_HDR_SZ;
    928          
    929          #if 0  /* Unsupported  */
    930            uint16 panID;
    931            zAddrType_t devAddr;
    932          
    933            /* Address mode */
    934            devAddr.addrMode = *pBuf++;
    935          
    936            /* Address based on the address mode */
    937            MT_UtilSpi2Addr( &devAddr, pBuf);
    938            pBuf += Z_EXTADDR_LEN;
    939          
    940            /* PanID */
    941            panID = BUILD_UINT16( pBuf[0] , pBuf[1] );
    942          
    943            /* Call the routine */
    944            retArray[1] =  ZMacSrcMatchCheckSrcAddr (&devAddr, panID);
    945          
    946              /* Return failure if the index is invalid */
    947            if (retArray[1] == ZMacSrcMatchInvalidIndex )
    948            {
    949              retArray[0] = ZFailure;
    950            }
    951            else
    952            {
    953              retArray[0] = ZSuccess;
    954            }
    955          #else
    956            retArray[0] = ZMacUnsupported;
    957            retArray[1] = ZMacSrcMatchInvalidIndex;
   \                     ??CrossCallReturnLabel_18:
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   74FF         MOV     A,#-0x1
   \   000011                REQUIRE ?Subroutine5
   \   000011                ; // Fall through to label ?Subroutine5
    958          #endif
    959          
    960            /* Build and send back the response */
    961            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 2, retArray );
    962          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   000003   7967         MOV     R1,#0x67
   \   000005   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000008   7402         MOV     A,#0x2
   \   00000A   80..         SJMP    ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_50:
   \   000003   F0           MOVX    @DPTR,A
   \   000004   7401         MOV     A,#0x1
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   000003   7B02         MOV     R3,#0x2
   \   000005   22           RET
    963          
    964          /***************************************************************************************************
    965           * @fn          MT_UtilSrcMatchAckAllPending
    966           *
    967           * @brief       Enabled/disable acknowledging all packets with pending bit set
    968           *              It is normally enabled when adding new entries to
    969           *              the source address table fails due to the table is full, or
    970           *              disabled when more entries are deleted and the table has
    971           *              empty slots.
    972           *
    973           * @param       pBuf - Buffer contains the data
    974           *
    975           * @return      void
    976           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    977          void MT_UtilSrcMatchAckAllPending (uint8 *pBuf)
   \                     MT_UtilSrcMatchAckAllPending:
   \   000000   80..         SJMP    ?Subroutine3
    978          {
    979            uint8 retValue, cmdId;
    980          
    981            /* Parse header */
    982            cmdId = pBuf[MT_RPC_POS_CMD1];
    983            pBuf += MT_RPC_FRAME_HDR_SZ;
    984          
    985          #ifdef AUTO_PEND
    986            /* Call the routine */
    987            retValue = ZMacSrcMatchAckAllPending(*pBuf);
    988          #else
    989            retValue = ZMacUnsupported;
    990          #endif
    991          
    992            /* Build and send back the response */
    993            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    994          }
    995          
    996          /***************************************************************************************************
    997           * @fn          MT_UtilSrcMatchCheckAllPending
    998           *
    999           * @brief       Check if acknowledging all packets with pending bit set
   1000           *              is enabled.
   1001           *
   1002           * @param       pBuf - Buffer contains the data
   1003           *
   1004           * @return      void
   1005           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1006          void MT_UtilSrcMatchCheckAllPending (uint8 *pBuf)
   \                     MT_UtilSrcMatchCheckAllPending:
   1007          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 2
   \   000004   74FE         MOV     A,#-0x2
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   1008            uint8 retArray[2], cmdId;
   1009          
   1010            /* Parse header */
   1011            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000009   12....       LCALL   ?Subroutine15 & 0xFFFF
   1012            pBuf += MT_RPC_FRAME_HDR_SZ;
   1013          
   1014          #ifdef AUTO_PEND
   1015            /* Call the routine */
   1016            retArray[0] = ZMacSuccess;
   1017            retArray[1] = ZMacSrcMatchCheckAllPending();
   1018          #else
   1019            retArray[0] = ZMacUnsupported;
   1020            retArray[1] = FALSE;
   \                     ??CrossCallReturnLabel_19:
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E4           CLR     A
   \   000010   80..         SJMP    ?Subroutine5
   1021          #endif
   1022          
   1023            /* Build and send back the response */
   1024            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 2, retArray );
   1025          }
   1026          
   1027          /***************************************************************************************************
   1028           * SUPPORT
   1029           ***************************************************************************************************/
   1030          
   1031          #ifdef AUTO_PEND
   1032          /***************************************************************************************************
   1033           * @fn      MT_UtilRevExtCpy
   1034           *
   1035           * @brief
   1036           *
   1037           *   Reverse-copy an extended address.
   1038           *
   1039           * @param   pDst - Pointer to data destination
   1040           * @param   pSrc - Pointer to data source
   1041           *
   1042           * @return  void
   1043           ***************************************************************************************************/
   1044          static void MT_UtilRevExtCpy( uint8 *pDst, uint8 *pSrc )
   1045          {
   1046            int8 i;
   1047          
   1048            for ( i = Z_EXTADDR_LEN - 1; i >= 0; i-- )
   1049            {
   1050              *pDst++ = pSrc[i];
   1051            }
   1052          }
   1053          
   1054          /***************************************************************************************************
   1055           * @fn      MT_UtilSpi2Addr
   1056           *
   1057           * @brief   Copy an address from an SPI message to an address struct.  The
   1058           *          addrMode in pAddr must already be set.
   1059           *
   1060           * @param   pDst - Pointer to address struct
   1061           * @param   pSrc - Pointer SPI message byte array
   1062           *
   1063           * @return  void
   1064           ***************************************************************************************************/
   1065          static void MT_UtilSpi2Addr( zAddrType_t *pDst, uint8 *pSrc )
   1066          {
   1067            if ( pDst->addrMode == Addr16Bit )
   1068            {
   1069              pDst->addr.shortAddr = BUILD_UINT16( pSrc[0] , pSrc[1] );
   1070            }
   1071            else if ( pDst->addrMode == Addr64Bit )
   1072            {
   1073              MT_UtilRevExtCpy( pDst->addr.extAddr, pSrc );
   1074            }
   1075          }
   1076          #endif // AUTO_PEND
   1077          
   1078          #if !defined NONWK
   1079          /**************************************************************************************************
   1080           * @fn      MT_UtilDataReq
   1081           *
   1082           * @brief   Process the MAC Data Request command.
   1083           *
   1084           * @param   pBuf - pointer to the received data
   1085           *
   1086           * @return  None
   1087          **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   E9           MOV     A,R1
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007                REQUIRE ??Subroutine41_0
   \   000007                ; // Fall through to label ??Subroutine41_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1088          void MT_UtilDataReq(uint8 *pBuf)
   \                     MT_UtilDataReq:
   1089          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004   74FF         MOV     A,#-0x1
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   1090            uint8 rtrn = NwkPollReq(pBuf[MT_RPC_POS_DAT0]);
   \   000009                ; Setup parameters for call to function NwkPollReq
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F9           MOV     R1,A
   \   000012   12....       LCALL   ??NwkPollReq?relay
   \   000015   12....       LCALL   ?Subroutine23 & 0xFFFF
   1091            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), MT_UTIL_DATA_REQ,
   1092                                                                                         1, &rtrn);
   \                     ??CrossCallReturnLabel_63:
   \   000018   7A11         MOV     R2,#0x11
   \   00001A   80..         SJMP    ??Subroutine44_0
   1093          }
   1094          
   1095          /***************************************************************************************************
   1096           * @fn      MT_UtilAddrMgrEntryLookupExt
   1097           *
   1098           * @brief   Proxy the AddrMgrEntryLookupExt() function.
   1099           *
   1100           * @param   pBuf - pointer to the received buffer
   1101           *
   1102           * @return  void
   1103           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1104          static void MT_UtilAddrMgrEntryLookupExt(uint8 *pBuf)
   \                     MT_UtilAddrMgrEntryLookupExt:
   1105          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 15
   \   000005   74F1         MOV     A,#-0xf
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1106            uint8 nwkAddr[2];
   1107            AddrMgrEntry_t entry;
   1108            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   12....       LCALL   ?Subroutine14 & 0xFFFF
   1109            pBuf += MT_RPC_FRAME_HDR_SZ;
   1110          
   1111            osal_memcpy(entry.extAddr, pBuf, Z_EXTADDR_LEN);
   \                     ??CrossCallReturnLabel_17:
   \   00000D   89..         MOV     ?V0 + 0,R1
   \   00000F   8A..         MOV     ?V0 + 1,R2
   \   000011   75..00       MOV     ?V0 + 2,#0x0
   \   000014   78..         MOV     R0,#?V0 + 0
   \   000016   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000019   7C08         MOV     R4,#0x8
   \   00001B   7D00         MOV     R5,#0x0
   \   00001D   EC           MOV     A,R4
   \   00001E   12....       LCALL   ?XSTACK_DISP0_8
   \   000021   AA82         MOV     R2,DPL
   \   000023   AB83         MOV     R3,DPH
   \   000025   12....       LCALL   ??osal_memcpy?relay
   \   000028   7403         MOV     A,#0x3
   \   00002A   12....       LCALL   ?DEALLOC_XSTACK8
   1112            (void)AddrMgrEntryLookupExt(&entry);
   \   00002D                ; Setup parameters for call to function AddrMgrEntryLookupExt
   \   00002D   7402         MOV     A,#0x2
   \   00002F   12....       LCALL   ?XSTACK_DISP0_8
   \   000032   AA82         MOV     R2,DPL
   \   000034   AB83         MOV     R3,DPH
   \   000036   12....       LCALL   ??AddrMgrEntryLookupExt?relay
   1113            
   1114            nwkAddr[0] = LO_UINT16(entry.nwkAddr);
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   12....       LCALL   ?Subroutine17 & 0xFFFF
   1115            nwkAddr[1] = HI_UINT16(entry.nwkAddr);
   \                     ??CrossCallReturnLabel_22:
   \   000041   7403         MOV     A,#0x3
   \   000043   12....       LCALL   ?XSTACK_DISP0_8
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   C0E0         PUSH    A
   \   00004A   7401         MOV     A,#0x1
   \   00004C   12....       LCALL   ?XSTACK_DISP0_8
   \   00004F   D0E0         POP     A
   \   000051   12....       LCALL   ?Subroutine21 & 0xFFFF
   1116            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
   1117                                                 cmdId, sizeof(uint16), nwkAddr);
   \                     ??CrossCallReturnLabel_30:
   \   000054   EE           MOV     A,R6
   \   000055   FA           MOV     R2,A
   \   000056   7967         MOV     R1,#0x67
   \   000058   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1118          }
   \   00005B   740F         MOV     A,#0xf
   \   00005D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000060   7F03         MOV     R7,#0x3
   \   000062   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_52:
   \   000003   A982         MOV     R1,DPL
   \   000005   AA83         MOV     R2,DPH
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FE           MOV     R6,A
   \   000008                ; Setup parameters for call to function osal_memcpy
   \   000008                ; Setup parameters for call to function osal_memcpy
   \   000008                ; Setup parameters for call to function packDev_t
   \   000008                ; Setup parameters for call to function AssocFindDevice
   \   000008   8A82         MOV     DPL,R2
   \   00000A   8B83         MOV     DPH,R3
   \   00000C   A3           INC     DPTR
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   F0           MOVX    @DPTR,A
   \   000008   22           RET
   1119          
   1120          /***************************************************************************************************
   1121           * @fn      MT_UtilAddrMgrEntryLookupNwk
   1122           *
   1123           * @brief   Proxy the AddrMgrEntryLookupNwk() function.
   1124           *
   1125           * @param   pBuf - pointer to the received buffer
   1126           *
   1127           * @return  void
   1128           ***************************************************************************************************/
   1129          static void MT_UtilAddrMgrEntryLookupNwk(uint8 *pBuf)
   1130          {
   1131            AddrMgrEntry_t entry;
   1132            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1133            pBuf += MT_RPC_FRAME_HDR_SZ;
   1134          
   1135            entry.nwkAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   1136            (void)AddrMgrEntryLookupNwk(&entry);
   1137          
   1138            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
   1139                                                 cmdId, Z_EXTADDR_LEN, entry.extAddr);
   1140          }
   1141          
   1142          #if defined MT_SYS_KEY_MANAGEMENT
   1143          /***************************************************************************************************
   1144           * @fn      MT_UtilAPSME_LinkKeyDataGet
   1145           *
   1146           * @brief   Retrieves APS Link Key data from NV.
   1147           *
   1148           * @param   pBuf - pointer to the received buffer
   1149           *
   1150           * @return  void
   1151           ***************************************************************************************************/
   1152          static void MT_UtilAPSME_LinkKeyDataGet(uint8 *pBuf)
   1153          {
   1154            uint8 rsp[MT_APSME_LINKKEY_GET_RSP_LEN];
   1155            APSME_LinkKeyData_t *pData = NULL;
   1156            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1157            uint16 apsLinkKeyNvId;
   1158            uint32 *apsRxFrmCntr;
   1159            uint32 *apsTxFrmCntr;
   1160          
   1161            pBuf += MT_RPC_FRAME_HDR_SZ;
   1162          
   1163            *rsp = APSME_LinkKeyNVIdGet(pBuf, &apsLinkKeyNvId);
   1164          
   1165            if (SUCCESS == *rsp)
   1166            {
   1167              pData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
   1168          
   1169              if (pData != NULL)
   1170              {
   1171                // retrieve key from NV
   1172                if ( osal_nv_read( apsLinkKeyNvId, 0,
   1173                                  sizeof(APSME_LinkKeyData_t), pData) == SUCCESS)
   1174          
   1175                {
   1176                  apsRxFrmCntr = &ApsLinkKeyFrmCntr[apsLinkKeyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr;
   1177                  apsTxFrmCntr = &ApsLinkKeyFrmCntr[apsLinkKeyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr;
   1178          
   1179                  uint8 *ptr = rsp+1;
   1180                  (void)osal_memcpy(ptr, pData->key, SEC_KEY_LEN);
   1181                  ptr += SEC_KEY_LEN;
   1182                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 0);
   1183                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 1);
   1184                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 2);
   1185                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 3);
   1186                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 0);
   1187                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 1);
   1188                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 2);
   1189                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 3);
   1190                }
   1191          
   1192                // clear copy of key in RAM
   1193                osal_memset( pData, 0x00, sizeof(APSME_LinkKeyData_t) );
   1194          
   1195                osal_mem_free(pData);
   1196              }
   1197            }
   1198            else
   1199            {
   1200              // set data key and counters 0xFF
   1201              osal_memset(&rsp[1], 0xFF, SEC_KEY_LEN + (MT_UTIL_FRM_CTR_LEN * 2));
   1202            }
   1203          
   1204            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1205                                                 MT_APSME_LINKKEY_GET_RSP_LEN, rsp);
   1206          
   1207            // clear key data
   1208            osal_memset(rsp, 0x00, MT_APSME_LINKKEY_GET_RSP_LEN);
   1209          
   1210          }
   1211          
   1212          /***************************************************************************************************
   1213           * @fn      MT_UtilAPSME_LinkKeyNvIdGet
   1214           *
   1215           * @brief   Retrieves APS Link Key NV ID from the entry table.
   1216           *
   1217           * @param   pBuf - pointer to the received buffer
   1218           *
   1219           * @return  void
   1220           ***************************************************************************************************/
   1221          static void MT_UtilAPSME_LinkKeyNvIdGet(uint8 *pBuf)
   1222          {
   1223            uint8 rsp[MT_APSME_LINKKEY_NV_ID_GET_RSP_LEN];
   1224            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1225            uint16 apsLinkKeyNvId;
   1226          
   1227            pBuf += MT_RPC_FRAME_HDR_SZ;
   1228          
   1229            *rsp = APSME_LinkKeyNVIdGet(pBuf, &apsLinkKeyNvId);
   1230          
   1231            if (SUCCESS == *rsp)
   1232            {
   1233              rsp[1] = LO_UINT16(apsLinkKeyNvId);
   1234              rsp[2] = HI_UINT16(apsLinkKeyNvId);
   1235            }
   1236            else
   1237            {
   1238              // send failure response with invalid NV ID
   1239              osal_memset(&rsp[1], 0xFF, 2);
   1240            }
   1241          
   1242            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1243                                                 MT_APSME_LINKKEY_NV_ID_GET_RSP_LEN, rsp);
   1244          }
   1245          #endif // MT_SYS_KEY_MANAGEMENT
   1246          
   1247          /***************************************************************************************************
   1248           * @fn      MT_UtilAPSME_RequestKeyCmd
   1249           *
   1250           * @brief   Send RequestKey command message to TC for a specific partner Address.
   1251           *
   1252           * @param   pBuf  - pointer to the received buffer
   1253           *
   1254           * @return  void
   1255           ***************************************************************************************************/
   1256          void MT_UtilAPSME_RequestKeyCmd(uint8 *pBuf)
   1257          {
   1258            uint8 cmdId;
   1259            uint8 partnerAddr[Z_EXTADDR_LEN];
   1260            uint8 retValue;
   1261          
   1262            // parse header
   1263            cmdId = pBuf[MT_RPC_POS_CMD1];
   1264            pBuf += MT_RPC_FRAME_HDR_SZ;
   1265          
   1266            /* PartnerAddress */
   1267            osal_memcpy(partnerAddr, pBuf, Z_EXTADDR_LEN);
   1268          
   1269            retValue = (uint8)ZDSecMgrRequestAppKey(partnerAddr);
   1270          
   1271            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
   1272          }
   1273          
   1274          /***************************************************************************************************
   1275           * @fn      MT_UtilAssocCount
   1276           *
   1277           * @brief   Proxy the AssocCount() function.
   1278           *
   1279           * @param   pBuf - pointer to the received buffer
   1280           *
   1281           * @return  void
   1282           ***************************************************************************************************/
   1283          static void MT_UtilAssocCount(uint8 *pBuf)
   1284          {
   1285            uint16 cnt;
   1286            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1287            pBuf += MT_RPC_FRAME_HDR_SZ;
   1288          
   1289            cnt = AssocCount(pBuf[0], pBuf[1]);
   1290            pBuf[0] = LO_UINT16(cnt);
   1291            pBuf[1] = HI_UINT16(cnt);
   1292          
   1293            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 2, pBuf);
   1294          }
   1295          
   1296          /***************************************************************************************************
   1297           * @fn      MT_UtilAssocFindDevice
   1298           *
   1299           * @brief   Get an associated device by index.
   1300           *
   1301           * @param   pBuf - pointer to the received buffer
   1302           *
   1303           * @return  void
   1304           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1305          static void MT_UtilAssocFindDevice(uint8 *pBuf)
   \                     MT_UtilAssocFindDevice:
   1306          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV     A,#-0x12
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1307            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   12....       LCALL   ?Subroutine34 & 0xFFFF
   1308            uint8 buf[sizeof(associated_devices_t)];
   1309          
   1310            packDev_t(buf, AssocFindDevice(pBuf[MT_RPC_FRAME_HDR_SZ]));
   \                     ??CrossCallReturnLabel_53:
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   12....       LCALL   ??AssocFindDevice?relay
   \   000012   12....       LCALL   ?Subroutine29 & 0xFFFF
   1311            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1312                                                 sizeof(associated_devices_t), buf);
   \                     ??CrossCallReturnLabel_44:
   \   000015   EE           MOV     A,R6
   \   000016   FA           MOV     R2,A
   \   000017                REQUIRE ?Subroutine2
   \   000017                ; // Fall through to label ?Subroutine2
   1313          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7967         MOV     R1,#0x67
   \   000002   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000005   7412         MOV     A,#0x12
   \   000007                REQUIRE ??Subroutine46_0
   \   000007                ; // Fall through to label ??Subroutine46_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   EA           MOV     A,R2
   \   000001   FC           MOV     R4,A
   \   000002   EB           MOV     A,R3
   \   000003   FD           MOV     R5,A
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   AA82         MOV     R2,DPL
   \   00000C   AB83         MOV     R3,DPH
   \   00000E   12....       LCALL   ??packDev_t?relay
   \   000011                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000011                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   AC82         MOV     R4,DPL
   \   000019   AD83         MOV     R5,DPH
   \   00001B   7B12         MOV     R3,#0x12
   \   00001D   22           RET
   1314          
   1315          /***************************************************************************************************
   1316           * @fn      MT_UtilAssocGetWithAddress
   1317           *
   1318           * @brief   Get an associated device by address.
   1319           *
   1320           * @param   pBuf - pointer to the received buffer
   1321           *
   1322           * @return  void
   1323           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1324          static void MT_UtilAssocGetWithAddress(uint8 *pBuf)
   \                     MT_UtilAssocGetWithAddress:
   1325          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV     A,#-0x12
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1326            extern associated_devices_t *AssocGetWithAddress(uint8 *extAddr, uint16 shortAddr);
   1327            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 0,A
   1328            uint8 buf[sizeof(associated_devices_t)];
   1329          
   1330            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000017   12....       LCALL   ?Subroutine16 & 0xFFFF
   1331            packDev_t(buf, AssocGetWithAddress(((AddrMgrExtAddrValid(pBuf)) ? pBuf : NULL),
   1332                                            BUILD_UINT16(pBuf[Z_EXTADDR_LEN], pBuf[Z_EXTADDR_LEN+1])));
   \                     ??CrossCallReturnLabel_20:
   \   00001A                ; Setup parameters for call to function AddrMgrExtAddrValid
   \   00001A   0A           INC     R2
   \   00001B   0A           INC     R2
   \   00001C   0A           INC     R2
   \   00001D   FB           MOV     R3,A
   \   00001E   12....       LCALL   ??AddrMgrExtAddrValid?relay
   \   000021   E9           MOV     A,R1
   \   000022   6006         JZ      ??MT_UtilAssocGetWithAddress_0
   \   000024   EE           MOV     A,R6
   \   000025   FA           MOV     R2,A
   \   000026   EF           MOV     A,R7
   \   000027   FB           MOV     R3,A
   \   000028   8004         SJMP    ??MT_UtilAssocGetWithAddress_1
   \                     ??MT_UtilAssocGetWithAddress_0:
   \   00002A   7A00         MOV     R2,#0x0
   \   00002C   7B00         MOV     R3,#0x0
   \                     ??MT_UtilAssocGetWithAddress_1:
   \   00002E                ; Setup parameters for call to function packDev_t
   \   00002E                ; Setup parameters for call to function AssocGetWithAddress
   \   00002E   8E82         MOV     DPL,R6
   \   000030   8F83         MOV     DPH,R7
   \   000032   A3           INC     DPTR
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   A3           INC     DPTR
   \   000038   A3           INC     DPTR
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   FC           MOV     R4,A
   \   00003C   8E82         MOV     DPL,R6
   \   00003E   8F83         MOV     DPH,R7
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   F9           MOV     R1,A
   \   00004B   EC           MOV     A,R4
   \   00004C   2400         ADD     A,#0x0
   \   00004E   E4           CLR     A
   \   00004F   39           ADDC    A,R1
   \   000050   FD           MOV     R5,A
   \   000051   12....       LCALL   ??AssocGetWithAddress?relay
   \   000054   12....       LCALL   ?Subroutine29 & 0xFFFF
   1333          
   1334            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1335                                                 sizeof(associated_devices_t), buf);
   \                     ??CrossCallReturnLabel_45:
   \   000057   AA..         MOV     R2,?V0 + 0
   \   000059   80..         SJMP    ?Subroutine2
   1336          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   EE           MOV     A,R6
   \   000001   2403         ADD     A,#0x3
   \   000003   0E           INC     R6
   \   000004   0E           INC     R6
   \   000005   0E           INC     R6
   \   000006   EF           MOV     A,R7
   \   000007   3400         ADDC    A,#0x0
   \   000009   FF           MOV     R7,A
   \   00000A   22           RET
   1337          
   1338          /***************************************************************************************************
   1339           * @fn      packDev_t
   1340           *
   1341           * @brief   Pack an associated_devices_t structure into a byte buffer (pack INVALID_NODE_ADDR if
   1342           *          the pDev parameter is NULL).
   1343           *
   1344           * @param   pBuf - pointer to the buffer into which to pack the structure.
   1345           * @param   pDev - pointer to the structure.
   1346           *
   1347           * @return  void
   1348           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1349          static void packDev_t(uint8 *pBuf, associated_devices_t *pDev)
   \                     packDev_t:
   1350          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1351            if (NULL == pDev)
   \   000005   EC           MOV     A,R4
   \   000006   4D           ORL     A,R5
   \   000007   700C         JNZ     ??packDev_t_0
   1352            {
   1353              uint16 rtrn = INVALID_NODE_ADDR;
   1354              *pBuf++ = LO_UINT16(rtrn);
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   74FE         MOV     A,#-0x2
   \   00000F   F0           MOVX    @DPTR,A
   \   000010   A3           INC     DPTR
   1355              *pBuf++ = HI_UINT16(rtrn);
   \   000011   04           INC     A
   \   000012   02....       LJMP    ??CrossCallReturnLabel_9 & 0xFFFF
   1356            }
   1357            else
   1358            {
   1359              *pBuf++ = LO_UINT16(pDev->shortAddr);
   \                     ??packDev_t_0:
   \   000015   8C82         MOV     DPL,R4
   \   000017   8D83         MOV     DPH,R5
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   F0           MOVX    @DPTR,A
   \   00001F   A3           INC     DPTR
   \   000020   AA82         MOV     R2,DPL
   \   000022   AB83         MOV     R3,DPH
   1360              *pBuf++ = HI_UINT16(pDev->shortAddr);
   \   000024   8C82         MOV     DPL,R4
   \   000026   8D83         MOV     DPH,R5
   \   000028   12....       LCALL   ?Subroutine10 & 0xFFFF
   1361              *pBuf++ = LO_UINT16(pDev->addrIdx);
   \                     ??CrossCallReturnLabel_74:
   \   00002B   2402         ADD     A,#0x2
   \   00002D   12....       LCALL   ?Subroutine9 & 0xFFFF
   1362              *pBuf++ = HI_UINT16(pDev->addrIdx);
   \                     ??CrossCallReturnLabel_8:
   \   000030   12....       LCALL   ?Subroutine40 & 0xFFFF
   1363              *pBuf++ = pDev->nodeRelation;
   \                     ??CrossCallReturnLabel_82:
   \   000033   8C82         MOV     DPL,R4
   \   000035   8D83         MOV     DPH,R5
   \   000037   A3           INC     DPTR
   \   000038   A3           INC     DPTR
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   12....       LCALL   ?Subroutine11 & 0xFFFF
   1364              *pBuf++ = pDev->devStatus;
   \                     ??CrossCallReturnLabel_10:
   \   00003E   12....       LCALL   ?Subroutine11 & 0xFFFF
   1365              *pBuf++ = pDev->assocCnt;
   \                     ??CrossCallReturnLabel_11:
   \   000041   A3           INC     DPTR
   \   000042   12....       LCALL   ?Subroutine8 & 0xFFFF
   1366              *pBuf++ = pDev->age;
   \                     ??CrossCallReturnLabel_6:
   \   000045   12....       LCALL   ?Subroutine8 & 0xFFFF
   1367              *pBuf++ = pDev->linkInfo.txCounter;
   \                     ??CrossCallReturnLabel_7:
   \   000048   A3           INC     DPTR
   \   000049   12....       LCALL   ?Subroutine7 & 0xFFFF
   1368              *pBuf++ = pDev->linkInfo.txCost;
   \                     ??CrossCallReturnLabel_4:
   \   00004C   12....       LCALL   ?Subroutine7 & 0xFFFF
   1369              *pBuf++ = pDev->linkInfo.rxLqi;
   \                     ??CrossCallReturnLabel_5:
   \   00004F   12....       LCALL   ?Subroutine10 & 0xFFFF
   1370              *pBuf++ = pDev->linkInfo.inKeySeqNum;
   \                     ??CrossCallReturnLabel_75:
   \   000052   240B         ADD     A,#0xb
   \   000054   F582         MOV     DPL,A
   \   000056   ED           MOV     A,R5
   \   000057   3400         ADDC    A,#0x0
   \   000059   F583         MOV     DPH,A
   \   00005B   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   1371              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 0);
   \                     ??CrossCallReturnLabel_76:
   \   00005E   240C         ADD     A,#0xc
   \   000060   F8           MOV     R0,A
   \   000061   ED           MOV     A,R5
   \   000062   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   000065   78..         MOV     R0,#?V0 + 0
   \   000067   12....       LCALL   ?L_MOV_X
   \   00006A   12....       LCALL   ?Subroutine20 & 0xFFFF
   1372              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 1);
   \                     ??CrossCallReturnLabel_71:
   \   00006D   12....       LCALL   ?L_MOV_X
   \   000070   E5..         MOV     A,?V0 + 1
   \   000072   8A82         MOV     DPL,R2
   \   000074   8B83         MOV     DPH,R3
   \   000076   12....       LCALL   ??Subroutine47_0 & 0xFFFF
   1373              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 2);
   \                     ??CrossCallReturnLabel_73:
   \   000079   12....       LCALL   ?L_MOV_X
   \   00007C   7410         MOV     A,#0x10
   \   00007E   78..         MOV     R0,#?V0 + 0
   \   000080   12....       LCALL   ?UL_SHR
   \   000083   12....       LCALL   ?Subroutine20 & 0xFFFF
   1374              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 3);
   \                     ??CrossCallReturnLabel_72:
   \   000086   12....       LCALL   ?L_MOV_X
   \   000089   7418         MOV     A,#0x18
   \   00008B   78..         MOV     R0,#?V0 + 0
   \   00008D   12....       LCALL   ?UL_SHR
   \   000090   8A82         MOV     DPL,R2
   \   000092   8B83         MOV     DPH,R3
   \   000094   E5..         MOV     A,?V0 + 0
   \   000096   12....       LCALL   ?Subroutine40 & 0xFFFF
   1375              *pBuf++ = LO_UINT16(pDev->linkInfo.txFailure);
   \                     ??CrossCallReturnLabel_83:
   \   000099   EC           MOV     A,R4
   \   00009A   2410         ADD     A,#0x10
   \   00009C   12....       LCALL   ?Subroutine9 & 0xFFFF
   1376              *pBuf++ = HI_UINT16(pDev->linkInfo.txFailure);
   1377            }
   \                     ??CrossCallReturnLabel_9:
   \   00009F   F0           MOVX    @DPTR,A
   1378          }
   \   0000A0                REQUIRE ?Subroutine4
   \   0000A0                ; // Fall through to label ?Subroutine4

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   E5..         MOV     A,?V0 + 0
   \   000006                REQUIRE ??Subroutine47_0
   \   000006                ; // Fall through to label ??Subroutine47_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine47_0:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_84:
   \   000003   8E82         MOV     DPL,R6
   \   000005   8F83         MOV     DPH,R7
   \   000007   78..         MOV     R0,#?V0 + 0
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F9           MOV     R1,A
   \   000003   E8           MOV     A,R0
   \   000004   FE           MOV     R6,A
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
   \   000007   8E82         MOV     DPL,R6
   \   000009   8F83         MOV     DPH,R7
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   12....       LCALL   ?Subroutine31 & 0xFFFF
   \                     ??CrossCallReturnLabel_78:
   \   000003   8C82         MOV     DPL,R4
   \   000005   8D83         MOV     DPH,R5
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   A3           INC     DPTR
   \   000001                REQUIRE ??Subroutine48_0
   \   000001                ; // Fall through to label ??Subroutine48_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine48_0:
   \   000000   12....       LCALL   ?Subroutine31 & 0xFFFF
   \                     ??CrossCallReturnLabel_79:
   \   000003   EC           MOV     A,R4
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_81:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine38:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_85:
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine40:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   0A           INC     R2
   \   000003   AB83         MOV     R3,DPH
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   F8           MOV     R0,A
   \   000001   ED           MOV     A,R5
   \   000002   3400         ADDC    A,#0x0
   \   000004   F9           MOV     R1,A
   \   000005   8882         MOV     DPL,R0
   \   000007   8983         MOV     DPH,R1
   \   000009   12....       LCALL   ?Subroutine31 & 0xFFFF
   \                     ??CrossCallReturnLabel_77:
   \   00000C   8882         MOV     DPL,R0
   \   00000E   8983         MOV     DPH,R1
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_46:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_80:
   \   000003   8C82         MOV     DPL,R4
   \   000005   8D83         MOV     DPH,R5
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   A3           INC     DPTR
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   22           RET
   1379          
   1380          #if defined ZCL_KEY_ESTABLISH
   1381          /***************************************************************************************************
   1382           * @fn      MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
   1383           *
   1384           * @brief   Proxy the zclGeneral_KeyEstablish_InitiateKeyEstablishment() function.
   1385           *
   1386           * @param   pBuf - pointer to the received buffer
   1387           *
   1388           * @return  void
   1389           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1390          static void MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(uint8 *pBuf)
   \                     MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment:
   1391          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 12
   \   000005   74F4         MOV     A,#-0xc
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1392            afAddrType_t partnerAddr;
   1393            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 3,A
   1394            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000017   12....       LCALL   ?Subroutine16 & 0xFFFF
   1395          
   1396            partnerAddr.panId = 0;  // Not an inter-pan message.
   \                     ??CrossCallReturnLabel_21:
   \   00001A   740A         MOV     A,#0xa
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E4           CLR     A
   \   000020   F0           MOVX    @DPTR,A
   \   000021   A3           INC     DPTR
   \   000022   12....       LCALL   ?Subroutine26 & 0xFFFF
   1397            partnerAddr.endPoint = pBuf[2];
   \                     ??CrossCallReturnLabel_35:
   \   000025   A3           INC     DPTR
   \   000026   E0           MOVX    A,@DPTR
   \   000027   C0E0         PUSH    A
   \   000029   7409         MOV     A,#0x9
   \   00002B   12....       LCALL   ?XSTACK_DISP0_8
   \   00002E   D0E0         POP     A
   \   000030   12....       LCALL   ?Subroutine26 & 0xFFFF
   1398            partnerAddr.addrMode = (afAddrMode_t)pBuf[3];
   \                     ??CrossCallReturnLabel_36:
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F8           MOV     R0,A
   \   000037   7408         MOV     A,#0x8
   \   000039   12....       LCALL   ?XSTACK_DISP0_8
   \   00003C   E8           MOV     A,R0
   \   00003D   F0           MOVX    @DPTR,A
   1399            if (afAddr64Bit == partnerAddr.addrMode)
   \   00003E   7403         MOV     A,#0x3
   \   000040   68           XRL     A,R0
   \   000041   7029         JNZ     ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst_1
   1400            {
   1401              (void)osal_memcpy(partnerAddr.addr.extAddr, pBuf+4, Z_EXTADDR_LEN);
   \   000043                ; Setup parameters for call to function osal_memcpy
   \   000043   EE           MOV     A,R6
   \   000044   2404         ADD     A,#0x4
   \   000046   F5..         MOV     ?V0 + 0,A
   \   000048   EF           MOV     A,R7
   \   000049   3400         ADDC    A,#0x0
   \   00004B   F5..         MOV     ?V0 + 1,A
   \   00004D   75..00       MOV     ?V0 + 2,#0x0
   \   000050   78..         MOV     R0,#?V0 + 0
   \   000052   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000055   7C08         MOV     R4,#0x8
   \   000057   7D00         MOV     R5,#0x0
   \   000059   7403         MOV     A,#0x3
   \   00005B   12....       LCALL   ?XSTACK_DISP0_8
   \   00005E   AA82         MOV     R2,DPL
   \   000060   AB83         MOV     R3,DPH
   \   000062   12....       LCALL   ??osal_memcpy?relay
   \   000065   7403         MOV     A,#0x3
   \   000067   12....       LCALL   ?DEALLOC_XSTACK8
   \   00006A   8020         SJMP    ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst_2
   1402            }
   1403            else
   1404            {
   1405              partnerAddr.addr.shortAddr = BUILD_UINT16(pBuf[4], pBuf[5]);
   \                     ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst_1:
   \   00006C   8E82         MOV     DPL,R6
   \   00006E   8F83         MOV     DPH,R7
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   E0           MOVX    A,@DPTR
   \   000075   FA           MOV     R2,A
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   A3           INC     DPTR
   \   00007B   A3           INC     DPTR
   \   00007C   A3           INC     DPTR
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   F9           MOV     R1,A
   \   000081   EA           MOV     A,R2
   \   000082   85..82       MOV     DPL,?XSP + 0
   \   000085   85..83       MOV     DPH,?XSP + 1
   \   000088   F0           MOVX    @DPTR,A
   \   000089   A3           INC     DPTR
   \   00008A   E9           MOV     A,R1
   \   00008B   F0           MOVX    @DPTR,A
   1406            }
   1407          
   1408            zcl_key_establish_task_id = pBuf[0];
   \                     ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst_2:
   \   00008C   8E82         MOV     DPL,R6
   \   00008E   8F83         MOV     DPH,R7
   \   000090   E0           MOVX    A,@DPTR
   \   000091   90....       MOV     DPTR,#zcl_key_establish_task_id
   \   000094   12....       LCALL   ?Subroutine26 & 0xFFFF
   1409            *pBuf = zclGeneral_KeyEstablish_InitiateKeyEstablishment(MT_TaskID, &partnerAddr, pBuf[1]);
   \                     ??CrossCallReturnLabel_37:
   \   000097   E0           MOVX    A,@DPTR
   \   000098   FC           MOV     R4,A
   \   000099   85..82       MOV     DPL,?XSP + 0
   \   00009C   85..83       MOV     DPH,?XSP + 1
   \   00009F   AA82         MOV     R2,DPL
   \   0000A1   AB83         MOV     R3,DPH
   \   0000A3   90....       MOV     DPTR,#MT_TaskID
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   F9           MOV     R1,A
   \   0000A8   12....       LCALL   ??zclGeneral_KeyEstablish_InitiateKeyEstablishm
   \   0000AB   E9           MOV     A,R1
   \   0000AC   8E82         MOV     DPL,R6
   \   0000AE   8F83         MOV     DPH,R7
   \   0000B0   F0           MOVX    @DPTR,A
   1410            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, pBuf);
   \   0000B1                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000B1   EE           MOV     A,R6
   \   0000B2   FC           MOV     R4,A
   \   0000B3   EF           MOV     A,R7
   \   0000B4   FD           MOV     R5,A
   \   0000B5   7B01         MOV     R3,#0x1
   \   0000B7   AA..         MOV     R2,?V0 + 3
   \   0000B9   7967         MOV     R1,#0x67
   \   0000BB   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1411          }
   \   0000BE   740C         MOV     A,#0xc
   \   0000C0   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000C3   02....       LJMP    ?Subroutine4 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function zclGeneral_KeyEstablish_InitiateKeyEstablishment
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   22           RET
   1412          
   1413          /***************************************************************************************************
   1414           * @fn      MT_UtilzclGeneral_KeyEstablishment_ECDSASign
   1415           *
   1416           * @brief   Proxy the zclGeneral_KeyEstablishment_ECDSASign() function.
   1417           *
   1418           * @param   pBuf - pointer to the received buffer
   1419           *
   1420           * @return  void
   1421           ***************************************************************************************************/
   1422          static void MT_UtilzclGeneral_KeyEstablishment_ECDSASign(uint8 *pBuf)
   1423          {
   1424          #if defined TC_LINKKEY_JOIN
   1425            uint8 *output = osal_mem_alloc(SE_PROFILE_SIGNATURE_LENGTH+1);
   1426            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1427            pBuf += MT_RPC_FRAME_HDR_SZ;
   1428          
   1429            if (NULL == output)
   1430            {
   1431              *pBuf = FAILURE;
   1432              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, pBuf);
   1433            }
   1434            else
   1435            {
   1436              *output = zclGeneral_KeyEstablishment_ECDSASign(pBuf+1, *pBuf, output+1);
   1437              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1438                                                   SE_PROFILE_SIGNATURE_LENGTH+1, output);
   1439              osal_mem_free(output);
   1440            }
   1441          #endif
   1442          }
   1443          
   1444          /***************************************************************************************************
   1445           * @fn      MT_UtilKeyEstablishInd
   1446           *
   1447           * @brief   Proxy the ZCL_KEY_ESTABLISH_IND command.
   1448           *
   1449           * @param   pInd - Pointer to a keyEstablishmentInd_t structure.
   1450           *
   1451           * @return  None
   1452           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1453          void MT_UtilKeyEstablishInd(keyEstablishmentInd_t *pInd)
   \                     MT_UtilKeyEstablishInd:
   1454          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 6
   \   000004   74FA         MOV     A,#-0x6
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   1455            uint8 msg[6];
   1456          
   1457            msg[0] = zcl_key_establish_task_id;
   \   000009   90....       MOV     DPTR,#zcl_key_establish_task_id
   \   00000C   12....       LCALL   ?Subroutine17 & 0xFFFF
   1458            msg[1] = pInd->hdr.event;
   \                     ??CrossCallReturnLabel_23:
   \   00000F   8A82         MOV     DPL,R2
   \   000011   8B83         MOV     DPH,R3
   \   000013   E0           MOVX    A,@DPTR
   \   000014   C0E0         PUSH    A
   \   000016   7401         MOV     A,#0x1
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   D0E0         POP     A
   \   00001D   F0           MOVX    @DPTR,A
   1459            msg[2] = pInd->hdr.status;
   \   00001E   8A82         MOV     DPL,R2
   \   000020   8B83         MOV     DPH,R3
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   C0E0         PUSH    A
   \   000026   7402         MOV     A,#0x2
   \   000028   12....       LCALL   ?XSTACK_DISP0_8
   \   00002B   D0E0         POP     A
   \   00002D   12....       LCALL   ?Subroutine39 & 0xFFFF
   1460            msg[3] = pInd->waitTime;
   \                     ??CrossCallReturnLabel_61:
   \   000030   C0E0         PUSH    A
   \   000032   7403         MOV     A,#0x3
   \   000034   12....       LCALL   ?XSTACK_DISP0_8
   \   000037   D0E0         POP     A
   \   000039   F0           MOVX    @DPTR,A
   1461            msg[4] = LO_UINT16(pInd->keyEstablishmentSuite);
   \   00003A   EA           MOV     A,R2
   \   00003B   2403         ADD     A,#0x3
   \   00003D   F8           MOV     R0,A
   \   00003E   EB           MOV     A,R3
   \   00003F   3400         ADDC    A,#0x0
   \   000041   F9           MOV     R1,A
   \   000042   8882         MOV     DPL,R0
   \   000044   8983         MOV     DPH,R1
   \   000046   E0           MOVX    A,@DPTR
   \   000047   C0E0         PUSH    A
   \   000049   7404         MOV     A,#0x4
   \   00004B   12....       LCALL   ?XSTACK_DISP0_8
   \   00004E   D0E0         POP     A
   \   000050   F0           MOVX    @DPTR,A
   1462            msg[5] = HI_UINT16(pInd->keyEstablishmentSuite);
   \   000051   8882         MOV     DPL,R0
   \   000053   8983         MOV     DPH,R1
   \   000055   A3           INC     DPTR
   \   000056   E0           MOVX    A,@DPTR
   \   000057   C0E0         PUSH    A
   \   000059   7405         MOV     A,#0x5
   \   00005B   12....       LCALL   ?XSTACK_DISP0_8
   \   00005E   D0E0         POP     A
   \   000060   12....       LCALL   ?Subroutine24 & 0xFFFF
   1463          
   1464            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_UTIL),
   1465                                                 MT_UTIL_ZCL_KEY_ESTABLISH_IND, 6, msg);
   \                     ??CrossCallReturnLabel_32:
   \   000063   7B06         MOV     R3,#0x6
   \   000065   7AE1         MOV     R2,#-0x1f
   \   000067   7947         MOV     R1,#0x47
   \   000069   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1466          }
   \   00006C   7406         MOV     A,#0x6
   \   00006E   02....       LJMP    ??Subroutine45_0 & 0xFFFF

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_ffffffff:
   \   000000   FFFFFFFF     DD 4294967295

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilCommandProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilCommandProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilGetDeviceInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilGetDeviceInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilGetNvInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilGetNvInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetPanID?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetPanID

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetChannels?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetChannels

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetSecLevel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetSecLevel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetPreCfgKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetPreCfgKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilCallbackSub?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilCallbackSub

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilTimeAlive?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilTimeAlive

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchEnable?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchEnable

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchAddEntry?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchAddEntry

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchDeleteEntry?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchDeleteEntry

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchCheckSrcAddr?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchCheckSrcAddr

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchAckAllPending?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchAckAllPending

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchCheckAllPending?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchCheckAllPending

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilDataReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilDataReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAddrMgrEntryLookupExt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAddrMgrEntryLookupExt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAssocFindDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAssocFindDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAssocGetWithAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAssocGetWithAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??packDev_t?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    packDev_t

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilKeyEstablishInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilKeyEstablishInd
   1467          #endif
   1468          
   1469          /***************************************************************************************************
   1470           * @fn      MT_UtilSync
   1471           *
   1472           * @brief   Process the MT_UTIL_SYNC command
   1473           *
   1474           * @param   None
   1475           *
   1476           * @return  None
   1477           ***************************************************************************************************/
   1478          static void MT_UtilSync(void)
   1479          {
   1480           MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ|(uint8)MT_RPC_SYS_UTIL),MT_UTIL_SYNC_REQ,0,0);
   1481          }
   1482          #endif /* !defined NONWK */
   1483          #endif /* MT_UTIL_FUNC */
   1484          /**************************************************************************************************
   1485           **************************************************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     MT_UtilAddrMgrEntryLookupExt       1      0     66
       -> osal_memcpy                   0      0     58
       -> AddrMgrEntryLookupExt         0      0     52
       -> MT_BuildAndSendZToolResponse
                                        0      0     52
     MT_UtilAssocFindDevice             0      0     64
       -> AssocFindDevice               0      0     54
       -> packDev_t                     0      0     54
       -> MT_BuildAndSendZToolResponse
                                        0      0     54
     MT_UtilAssocGetWithAddress         0      0     64
       -> AddrMgrExtAddrValid           0      0     54
       -> AssocGetWithAddress           0      0     54
       -> packDev_t                     0      0     54
       -> MT_BuildAndSendZToolResponse
                                        0      0     54
     MT_UtilCallbackSub                 0      0     47
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_UtilCommandProcessing           1      0     40
       -> MT_UtilGetDeviceInfo          0      0     74
       -> MT_UtilGetNvInfo              0      0     74
       -> MT_UtilSetPanID               0      0     74
       -> MT_UtilSetChannels            0      0     74
       -> MT_UtilSetSecLevel            0      0     74
       -> MT_UtilSetPreCfgKey           0      0     74
       -> MT_UtilCallbackSub            0      0     74
       -> MT_UtilTimeAlive              0      0     74
       -> MT_UtilSrcMatchEnable         0      0     74
       -> MT_UtilSrcMatchAddEntry       0      0     74
       -> MT_UtilSrcMatchDeleteEntry
                                        0      0     74
       -> MT_UtilSrcMatchCheckSrcAddr
                                        0      0     74
       -> MT_UtilSrcMatchAckAllPending
                                        0      0     74
       -> MT_UtilSrcMatchCheckAllPending
                                        0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> MT_UtilDataReq                0      0     74
       -> MT_UtilAddrMgrEntryLookupExt
                                        0      0     74
       -> AddrMgrEntryLookupNwk         0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> osal_memcpy                   0      0     80
       -> ZDSecMgrRequestAppKey         0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> AssocCount                    0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> MT_UtilAssocFindDevice        0      0     74
       -> MT_UtilAssocGetWithAddress
                                        0      0     74
       -> MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
                                        0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
     MT_UtilDataReq                     3      0     38
       -> NwkPollReq                    4      0      2
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilGetDeviceInfo               1      0     58
       -> AssocMakeList                 0      0     34
       -> osal_mem_alloc                0      0     34
       -> osal_nv_read                  0      0     42
       -> NLME_GetShortAddr             0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     34
       -> osal_mem_free                 0      0     34
       -> osal_mem_free                 0      0     34
     MT_UtilGetNvInfo                   1      0     63
       -> osal_mem_alloc                0      0     44
       -> osal_memset                   0      0     44
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> MT_BuildAndSendZToolResponse
                                        0      0     44
       -> osal_mem_free                 0      0     44
     MT_UtilKeyEstablishInd             3      0      6
       -> MT_BuildAndSendZToolResponse
                                        4      0     12
     MT_UtilSetChannels                 1      0     62
       -> osal_nv_item_len              0      0     46
       -> osal_nv_write                 0      0     50
       -> MT_BuildAndSendZToolResponse
                                        0      0     42
     MT_UtilSetPanID                    1      0     54
       -> osal_nv_item_len              0      0     30
       -> osal_nv_write                 0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     26
     MT_UtilSetPreCfgKey                1      0     52
       -> osal_nv_item_len              0      0     26
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_UtilSetSecLevel                 1      0     52
       -> osal_nv_item_len              0      0     26
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_UtilSrcMatchAckAllPending       2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilSrcMatchAddEntry            2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilSrcMatchCheckAllPending     2      0     39
       -> MT_BuildAndSendZToolResponse
                                        4      0      4
     MT_UtilSrcMatchCheckSrcAddr        2      0     39
       -> MT_BuildAndSendZToolResponse
                                        4      0      4
     MT_UtilSrcMatchDeleteEntry         2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilSrcMatchEnable              2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilTimeAlive                   1      0     57
       -> osal_GetSystemClock           0      0     40
       -> MT_BuildAndSendZToolResponse
                                        0      0     40
     MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
                                        1      0     64
       -> osal_memcpy                   0      0     54
       -> zclGeneral_KeyEstablish_InitiateKeyEstablishment
                                        0      0     48
       -> MT_BuildAndSendZToolResponse
                                        0      0     48
     packDev_t                          1      0     39


   Segment part sizes:

     Function/Label                                  Bytes
     --------------                                  -----
     zcl_key_establish_task_id                          1
     MT_UtilCommandProcessing                         529
     MT_UtilGetDeviceInfo                             277
     ?Subroutine27                                      4
     ?Subroutine22                                      6
     ??Subroutine42_0                                   8
     ?Subroutine6                                      11
     ?Subroutine37                                      9
     ?Subroutine0                                       8
     MT_UtilGetNvInfo                                 461
     MT_UtilSetPanID                                   75
     ?Subroutine25                                      4
     ?Subroutine36                                     13
     ?Subroutine19                                     22
     ??Subroutine43_0                                   8
     ?Subroutine28                                     12
     ?Subroutine12                                      9
     ?Subroutine32                                     16
     ?Subroutine39                                      9
     MT_UtilSetChannels                               158
     MT_UtilSetSecLevel                                30
     ?Subroutine1                                      15
     ?Subroutine13                                     16
     MT_UtilSetPreCfgKey                               32
     MT_UtilCallbackSub                               168
     ??Subroutine46_0                                   8
     MT_UtilTimeAlive                                 115
     ?Subroutine24                                      4
     ?Subroutine35                                     12
     ??Subroutine41_0                                   8
     MT_UtilSrcMatchEnable                              2
     ?Subroutine3                                      15
     ??Subroutine44_0                                   7
     ??Subroutine45_0                                  10
     ?Subroutine33                                     17
     MT_UtilSrcMatchAddEntry                            2
     MT_UtilSrcMatchDeleteEntry                         2
     MT_UtilSrcMatchCheckSrcAddr                       17
     ?Subroutine5                                      12
     ?Subroutine15                                      7
     ?Subroutine21                                      6
     MT_UtilSrcMatchAckAllPending                       2
     MT_UtilSrcMatchCheckAllPending                    18
     ?Subroutine23                                      7
     MT_UtilDataReq                                    28
     MT_UtilAddrMgrEntryLookupExt                     101
     ?Subroutine14                                      8
     ?Subroutine34                                     16
     ?Subroutine17                                      9
     MT_UtilAssocFindDevice                            23
     ?Subroutine2                                       7
     ?Subroutine29                                     30
     MT_UtilAssocGetWithAddress                        91
     ?Subroutine16                                     11
     packDev_t                                        160
     ?Subroutine4                                       5
     ?Subroutine20                                      6
     ??Subroutine47_0                                  10
     ?Subroutine18                                     12
     ?Subroutine11                                     13
     ?Subroutine10                                      1
     ??Subroutine48_0                                   5
     ?Subroutine31                                      4
     ?Subroutine38                                      9
     ?Subroutine40                                      6
     ?Subroutine9                                      23
     ?Subroutine8                                       4
     ?Subroutine30                                     15
     ?Subroutine7                                       6
     MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
                                                      198
     ?Subroutine26                                      7
     MT_UtilKeyEstablishInd                           113
     __Constant_ffffffff                                4
     __Constant_0                                       4
     __Constant_3e8                                     4
     ??MT_UtilCommandProcessing?relay                   6
     ??MT_UtilGetDeviceInfo?relay                       6
     ??MT_UtilGetNvInfo?relay                           6
     ??MT_UtilSetPanID?relay                            6
     ??MT_UtilSetChannels?relay                         6
     ??MT_UtilSetSecLevel?relay                         6
     ??MT_UtilSetPreCfgKey?relay                        6
     ??MT_UtilCallbackSub?relay                         6
     ??MT_UtilTimeAlive?relay                           6
     ??MT_UtilSrcMatchEnable?relay                      6
     ??MT_UtilSrcMatchAddEntry?relay                    6
     ??MT_UtilSrcMatchDeleteEntry?relay                 6
     ??MT_UtilSrcMatchCheckSrcAddr?relay                6
     ??MT_UtilSrcMatchAckAllPending?relay               6
     ??MT_UtilSrcMatchCheckAllPending?relay             6
     ??MT_UtilDataReq?relay                             6
     ??MT_UtilAddrMgrEntryLookupExt?relay               6
     ??MT_UtilAssocFindDevice?relay                     6
     ??MT_UtilAssocGetWithAddress?relay                 6
     ??packDev_t?relay                                  6
     ??MT_UtilzclGeneral_KeyEstablish_InitiateKeyEst    6
     ??MT_UtilKeyEstablishInd?relay                     6

 
 3 092 bytes in segment BANKED_CODE
   132 bytes in segment BANK_RELAYS
    12 bytes in segment XDATA_ROM_C
     1 byte  in segment XDATA_Z
 
 3 224 bytes of CODE  memory
     0 bytes of CONST memory (+ 12 bytes shared)
     1 byte  of XDATA memory

Errors: none
Warnings: none
